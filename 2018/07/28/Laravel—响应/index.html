<!DOCTYPE html><html class="appearance-auto" lang="zh-CN"><head><meta charset="UTF-8"><title>Laravel—响应</title><meta name="description" content="Wechat:934933088"><meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, initial-scale=1"><!-- Google Analytics --><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q || []).push(arguments)},i[r].l=1 * new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'G-M2RT7SDT3L', 'auto');
ga('send', 'pageview');</script><!-- End Google Analytics -->
<!-- Baidu Analytics --><script>var _hmt = _hmt || [];
(function() {
var hm = document.createElement("script");
hm.src = "//hm.baidu.com/hm.js?" + '54ebb03ad7ad5b762ac8ff7958df6d3f';
var s = document.getElementsByTagName("script")[0];
s.parentNode.insertBefore(hm, s);
})();</script><!-- End Baidu Analytics --><link rel="icon" href="https://qiniu.xiaoming.net.cn/%E5%8D%9A%E5%AE%A2%E5%9B%BE%E6%A0%87.jpeg"><link rel="stylesheet" href="/style/common/bulma.css"><link rel="stylesheet" href="/style/base.css"><link rel="stylesheet" href="/style/common/helper.css"><script src="/js/common.js"></script><link rel="stylesheet" href="/style/post.css"><link rel="stylesheet" href="/style/themes/highlight-theme-light.css"><script src="/js/highlight.pack.js"></script></head><body class="is-flex is-flex-direction-column"><header class="header-widget is-flex-shrink-0 is-hidden-mobile"><div class="container is-fullhd is-flex is-justify-content-space-between is-align-items-center is-full-height"><section class="is-hidden-mobile is-flex-shrink-0"><h2><a href="/">silverming's blog</a></h2></section><h3 class="is-hidden-mobile is-family-serif is-full-height is-flex is-align-items-center is-flex-shrink-0"><div class="is-full-height" id="postTopic"><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">Laravel—响应</p><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">点击返回顶部</p></div></h3><aside class="is-flex-shrink-0"><h3 class="is-inline-block"><a href="/">首页</a></h3><h3 class="is-inline-block"><a href="/about">关于</a></h3><h3 class="is-inline-block"><a href="/archives">归档</a></h3></aside></div></header><header class="is-flex header-widget is-flex-shrink-0 is-align-items-center is-justify-content-center is-hidden-tablet"><h3 class="is-inline-block"><a href="/">首页</a></h3><h3 class="is-inline-block"><a href="/about">关于</a></h3><h3 class="is-inline-block"><a href="/archives">归档</a></h3></header><main><main class="container is-max-widescreen content section post-page pt-4 px-4"><div class="columns is-flex-desktop is-justify-content-center is-flex-direction-row-reverse"><div class="column is-3 is-hidden-mobile"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#响应"><span class="toc-text">响应</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#字符串-amp-数组"><span class="toc-text">字符串 &amp; 数组</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Response类"><span class="toc-text">Response类</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#添加响应头"><span class="toc-text">添加响应头</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#添加Cookie到响应"><span class="toc-text">添加Cookie到响应</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Cookie加密"><span class="toc-text">Cookie加密</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#重定向"><span class="toc-text">重定向</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#使用辅助函数"><span class="toc-text">使用辅助函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#重定向到命名路由"><span class="toc-text">重定向到命名路由</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#重定向到控制器动作"><span class="toc-text">重定向到控制器动作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#重定向到外部域名"><span class="toc-text">重定向到外部域名</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#视图响应"><span class="toc-text">视图响应</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#JSON响应"><span class="toc-text">JSON响应</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#文件下载"><span class="toc-text">文件下载</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#文件响应"><span class="toc-text">文件响应</span></a></li></ol></li></ol></div><div class="column is-9"><header class="my-4"><a href="/tags/Laravel"><i class="tag post-item-tag">Laravel</i></a><a href="/tags/php"><i class="tag post-item-tag">php</i></a></header><h1 class="mt-0 mb-1 is-family-serif" id="postTitle">Laravel—响应</h1><time class="has-text-grey" datetime="2018-07-27T23:40:36.000Z">2018-07-28</time><article class="mt-2 post-content"><h1 id="响应"><a href="#响应" class="headerlink" title="响应"></a>响应</h1><p>所有路由、控制器处理完业务逻辑之后都会返回一个发送到用户浏览器的响应，Laravel提供多种不同的方式来获取响应,将数组转化为JSON响应</p>
<h2 id="字符串-amp-数组"><a href="#字符串-amp-数组" class="headerlink" title="字符串 &amp; 数组"></a>字符串 &amp; 数组</h2><p>直接在函数中使用<code>return</code>返回，框架会自动将字符串转换为一个完整的HTTP响应</p>
<pre><code class="php">Route::get(&#39;/&#39;,function()
{
    return &#39;Hello World&#39;;
});

Route::get(&#39;/&#39;,function()
{
    return [1,2,3];
});</code></pre>
<a id="more"></a>
<h2 id="Response类"><a href="#Response类" class="headerlink" title="Response类"></a>Response类</h2><p>返回一个完整的response实例允许自定义响应的HTTP状态码和头信息，Response实例继承自<code>Symfony\Component\HttpFoundation\Response</code>基类，该类提供了一系列方法用于创建HTTP响应  </p>
<h3 id="添加响应头"><a href="#添加响应头" class="headerlink" title="添加响应头"></a>添加响应头</h3><p><code>header</code>方法添加一系列响应头，也可以通过<code>withHeaders</code>方法指定头信息组添加到响应</p>
<pre><code class="php">
return response($content)
    -&gt;header(&#39;Content-Type&#39;,$type)
    -&gt;header(&#39;X-Header-One&#39;,&#39;Header Value&#39;)
    -&gt;header(&#39;X-Header-Two&#39;,&#39;Header Value&#39;);

//使用数组形式
return response($content)
    -&gt;withHeaders([
        &#39;Content-Type&#39; =&gt; $type,
        &#39;X-Header-One&#39; =&gt; &#39;Header Value&#39;,
        &#39;X-Header-Two&#39; =&gt; &#39;Header Value&#39;,
    ]);</code></pre>
<h3 id="添加Cookie到响应"><a href="#添加Cookie到响应" class="headerlink" title="添加Cookie到响应"></a>添加Cookie到响应</h3><p><code>cookie</code>方法生成Cookie并添加到响应实例</p>
<blockquote>
<p>return response-&gt;cookie(‘name’,’value’,$minutes);  </p>
</blockquote>
<p>还可以使用<code>Cookie</code>门面，<code>queue</code>方法接受cookie实例或创建的必要参数，这些Cookie会在响应被发送到浏览器之前添加到响应  </p>
<blockquote>
<p>Cookie::queue(‘author’,’value’,’minutes’);  </p>
</blockquote>
<h3 id="Cookie加密"><a href="#Cookie加密" class="headerlink" title="Cookie加密"></a>Cookie加密</h3><p>默认情况下，Laravel框架生成的Cookie都经过了加密的签名，以免在客户端被篡改。可以通过<code>app\Http\Middleware\EnctryptCookies</code>提供的<code>$except</code>属性取消特定的Cookie加密  </p>
<pre><code class="php">&lt;?php

namespace App\Http\Middleware;

use Illuminate\Cookie\Middleware\EncryptCookies as Middleware;

class EncryptCookies extends Middleware
{
    /**
     * The names of the cookies that should not be encrypted.
     *
     * @var array
     */
    protected $except = [
        //’cookie_name&#39;,
    ];
}
</code></pre>
<h2 id="重定向"><a href="#重定向" class="headerlink" title="重定向"></a>重定向</h2><p>重定向响应是<code>Illuminate\Http\RedirectResponse</code>类的实例，包含了必要的头信息将用户重定向到另一个URL  </p>
<h3 id="使用辅助函数"><a href="#使用辅助函数" class="headerlink" title="使用辅助函数"></a>使用辅助函数</h3><p><code>redirect</code>函数可以重定向到指定的地址  </p>
<pre><code class="php">Route::get(&#39;login&#39;,function()
{
    return redirect(&#39;home&#39;);
});</code></pre>
<p><code>back</code>函数返回到前一个URL</p>
<pre><code class="php">Route::post(&#39;user/profile&#39;,function()
{
    //返回上一个页面并自动在表单中填入已填信息
    return back()-&gt;withInput();
});</code></pre>
<h3 id="重定向到命名路由"><a href="#重定向到命名路由" class="headerlink" title="重定向到命名路由"></a>重定向到命名路由</h3><p>如果调用不带参数的<code>redirect</code>方法，会返回一个<code>Illuminate\Routing\Redirector</code>实例，然后可以使用<code>Redirector</code>实例上的所有方法，<code>route</code>方法可以重定向到指定的路由,如果路由有参数，可以将其作为第二个参数传递到<code>route</code>方法  </p>
<blockquote>
<p>return redirect()-&gt;route(‘login’,[‘id’=&gt;1]);  </p>
</blockquote>
<h3 id="重定向到控制器动作"><a href="#重定向到控制器动作" class="headerlink" title="重定向到控制器动作"></a>重定向到控制器动作</h3><p><code>action</code>方法可以生成控制器指定动作的URL，如果控制器有参数，可以将其作为第二个参数传递给<code>action</code>方法  </p>
<blockquote>
<p>return redirect()-&gt;action(‘UserController@profile’,[‘id’=&gt;1]);  </p>
</blockquote>
<h3 id="重定向到外部域名"><a href="#重定向到外部域名" class="headerlink" title="重定向到外部域名"></a>重定向到外部域名</h3><p><code>away</code>方法可以重定向到指定的网址  </p>
<blockquote>
<p>return redirect()-&gt;away(‘<a href="http://xiao-ming9.github.io&#39;" target="_blank" rel="noopener">http://xiao-ming9.github.io&#39;</a>);  </p>
</blockquote>
<h2 id="视图响应"><a href="#视图响应" class="headerlink" title="视图响应"></a>视图响应</h2><p><code>view</code>方法能够返回视图，也可以使用全局辅助函数<code>view</code></p>
<pre><code class="php">return response()
       -&gt;view(&#39;hello&#39;,$data,200);
       -&gt;header(&#39;Content-&gt;Type&#39;,$type);

//全局辅助函数
Route::get(&#39;/view/response&#39;,function(){
    return view(&#39;hello&#39;);
});</code></pre>
<h2 id="JSON响应"><a href="#JSON响应" class="headerlink" title="JSON响应"></a>JSON响应</h2><p><code>json</code>方法会自动将Content-Type头设置为<code>application/json</code>，并使用PHP函数将给定数组转化为JSON格式数据：</p>
<pre><code class="php">return response()-&gt;json([
    &#39;name&#39;=&gt;&#39;Abigail&#39;,
    &#39;state&#39;=&gt;&#39;CA&#39;
]);</code></pre>
<p>如果想要创建一个JSONP响应，可以在<code>json</code>方法之后调用<code>withCallback</code>方法</p>
<pre><code class="php">return response()
        -&gt;json([&#39;name&#39;=&gt;&#39;Abigail&#39;,&#39;state&#39; =&gt;&#39;CA&#39;])
        -&gt;withCallback($request-&gt;input(&#39;callback&#39;));</code></pre>
<p>也可以直接使用<code>jsonp</code>方法：</p>
<pre><code class="php">return response()
        -&gt;jsonp($request-&gt;input(&#39;callback&#39;),
        [&#39;name&#39;=&gt;&#39;Abigail&#39;,&#39;state&#39;=&gt;&#39;CA&#39;]);</code></pre>
<h2 id="文件下载"><a href="#文件下载" class="headerlink" title="文件下载"></a>文件下载</h2><p><code>download</code>方法用于生成用户浏览器下载给定路径文件的响应，第一参数为<strong>文件，可以使用相对路径(相对于public中的index.php）或绝对路径</strong>，第二第三参数可选，第二个参数为<strong>自定义文件名</strong>，第三个参数为<strong>HTTP头信息</strong></p>
<pre><code class="php">return response()-&gt;download($pathFile);
return response()-&gt;download($pathFile,$name,$headers);</code></pre>
<h2 id="文件响应"><a href="#文件响应" class="headerlink" title="文件响应"></a>文件响应</h2><p><code>file</code>方法可用于直接在用户浏览器显示文件，，接受文件路径作为第一个参数，头信息作为第二个参数</p>
<pre><code class="php">return response()-&gt;file($pathToFile);
return response()-&gt;file($pathToFile,$headers);</code></pre>
</article><section class="jump-container is-flex is-justify-content-space-between my-6"><!-- em is empty placeholder--><a class="button is-default" href="/2018/07/28/Laravel%E2%80%94blade%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E-%E8%A7%86%E5%9B%BE/" title="Laravel—视图、Blade模板引擎"><i class="iconfont icon-prev mr-2 has-text-grey"></i><span class="has-text-weight-semibold">上一页: Laravel—视图、Blade模板引擎</span></a><a class="button is-default" href="/2018/07/27/Laravel%E2%80%94%E8%AF%B7%E6%B1%82/" title="Laravel—请求"><span class="has-text-weight-semibold">下一页: Laravel—请求</span><i class="iconfont icon-next ml-2 has-text-grey"></i></a></section><article class="mt-6 comment-container"><script async repo="xiao-ming9/xiao-ming9.github.io" src="https://utteranc.es/client.js" issue-term="pathname" theme="preferred-color-scheme"></script></article></div></div></main></main><footer class="is-flex is-flex-direction-column is-align-items-center is-flex-shrink-0 is-family-serif"><section class="sns-container"><!-- Github--><!-- Ins--><!-- RSS--><!-- 知乎--><!-- 领英--><!-- 脸书--></section><p><span>Copyright ©</span><span> silverming 2021</span></p><div class="is-flex is-justify-content-center is-flex-wrap-wrap"><p>Powered by Hexo &verbar;&nbsp;</p><p class="is-flex is-justify-content-center"><a title="Hexo theme author" href="//github.com/haojen">Theme by Haojen&nbsp;</a></p><div style="margin-top: 2px"><a class="github-button" title="github-button" href="https://github.com/haojen/hexo-theme-Claudia" target="_blank" rel="noopener" data-color-scheme="no-preference: light; light: light; dark: dark;" data-show-count="true"></a></div></div><div><span>footnotes</span></div></footer><script async defer src="https://buttons.github.io/buttons.js"></script><script src="/js/post.js"></script></body></html>