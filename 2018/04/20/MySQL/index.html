<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.0.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    hostname: new URL('http://yoursite.com').hostname,
    root: '/',
    scheme: 'Mist',
    version: '7.5.0',
    exturl: false,
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false},
    copycode: {"enable":false,"show_result":false,"style":null},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":false},
    bookmark: {"enable":false,"color":"#222","save":"auto"},
    fancybox: false,
    mediumzoom: false,
    lazyload: false,
    pangu: false,
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":true},
    path: 'search.xml',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    sidebarPadding: 40
  };
</script>

  <meta name="description" content="MySQL基本命令MySQL数据库的一个实例可以同时包含多个数据库（每条命令结束后加分号），不区分大小写  查看当前实例下包含多少个数据库：12show databases；show CREATE DATABASE 数据库名；#查看创建库的信息 用户需要创建新的数据库：123create database [IF NOT EXISTS]数据库名；create database 数据库名 chara">
<meta property="og:type" content="article">
<meta property="og:title" content="MySQL">
<meta property="og:url" content="http:&#x2F;&#x2F;yoursite.com&#x2F;2018&#x2F;04&#x2F;20&#x2F;MySQL&#x2F;index.html">
<meta property="og:site_name" content="Silverming">
<meta property="og:description" content="MySQL基本命令MySQL数据库的一个实例可以同时包含多个数据库（每条命令结束后加分号），不区分大小写  查看当前实例下包含多少个数据库：12show databases；show CREATE DATABASE 数据库名；#查看创建库的信息 用户需要创建新的数据库：123create database [IF NOT EXISTS]数据库名；create database 数据库名 chara">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2019-03-29T04:04:02.000Z">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://yoursite.com/2018/04/20/MySQL/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: false,
    isPost: true,
    isPage: false,
    isArchive: false
  };
</script>

  <title>MySQL | Silverming</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Silverming</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
        <p class="site-subtitle">Stay hungry,stay foolish</p>
  </div>

  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i>关于</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>归档</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>

</nav>
  <div class="site-search">
    <div class="popup search-popup">
    <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocorrect="off" autocapitalize="none"
           placeholder="搜索..." spellcheck="false"
           type="text" id="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result"></div>

</div>
<div class="search-pop-overlay"></div>

  </div>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block " lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/04/20/MySQL/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Silverming">
      <meta itemprop="description" content="Wechat:934933088">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Silverming">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          MySQL
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2018-04-20 00:00:00" itemprop="dateCreated datePublished" datetime="2018-04-20T00:00:00+08:00">2018-04-20</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2019-03-29 12:04:02" itemprop="dateModified" datetime="2019-03-29T12:04:02+08:00">2019-03-29</time>
              </span>

          
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="MySQL基本命令"><a href="#MySQL基本命令" class="headerlink" title="MySQL基本命令"></a>MySQL基本命令</h1><p>MySQL数据库的一个实例可以同时包含多个数据库（每条命令结束后加分号），不区分大小写</p>
<ol>
<li>查看当前实例下包含多少个数据库：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">show databases；</span><br><span class="line">show CREATE DATABASE 数据库名；#查看创建库的信息</span><br></pre></td></tr></table></figure></li>
<li>用户需要创建新的数据库：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">create database [IF NOT EXISTS]数据库名；</span><br><span class="line">create database 数据库名 character set GBK/UTF-8/...;#指定编码</span><br><span class="line">show variables like &apos;character%&apos;;#查看编码</span><br></pre></td></tr></table></figure></li>
<li>删除指定数据库：</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">drop database 数据库名；</span><br></pre></td></tr></table></figure>
<a id="more"></a>
<ol start="4">
<li>进入数据库：</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">use 数据库名；</span><br><span class="line">select database();#查看当前选择的数据库</span><br></pre></td></tr></table></figure>
<p>5.进入数据库后，查询该数据库下包含多少个数据表：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show tables;</span><br></pre></td></tr></table></figure>
<p>6.查看指定数据表的表结构（查看该表有多少列，每列的数据类型等信息）：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">desc 表名；</span><br></pre></td></tr></table></figure>
<p>7.MySQL语句注释：使用“#”或者“–”，多行注释使用“/* */”</p>
<h1 id="MySQL数据库存储机制"><a href="#MySQL数据库存储机制" class="headerlink" title="MySQL数据库存储机制"></a>MySQL数据库存储机制</h1><ol>
<li>MySAM：对事务支持不够好</li>
<li>InnoDB：系统默认机制</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ENGING=MyISAM——强制使用第一种机制</span><br><span class="line">ENGING=InnoDB——强制使用第二种机制</span><br></pre></td></tr></table></figure>
<h1 id="SQL语句基础"><a href="#SQL语句基础" class="headerlink" title="SQL语句基础"></a>SQL语句基础</h1><ul>
<li>SQL 结构化查询语句 <h2 id="DDL语句：操作数据库对象的语句"><a href="#DDL语句：操作数据库对象的语句" class="headerlink" title="DDL语句：操作数据库对象的语句"></a>DDL语句：<code>操作数据库对象的语句</code></h2></li>
<li>包括创建（create）、删除（drop）、修改（alter）数据库对象</li>
<li><code>最基本的数据库对象是数据表，数据表是存储数据的逻辑单元</code></li>
<li>常见的数据库对象</li>
</ul>
<p>对象名称 | 对应关键字|描述<br>—|—|—|—<br>表 | table| 表以行和列的形式存在：列就是字段，行就是记录<br>数据字典 |  |就是系统表，存放数据库相关信息的表。<br>约束| constraint| 执行数据效验的规则，用于保证数据完整性的规则<br>视图| view| 一个或者多个数据表里数据的逻辑显示。视图并不存储数据<br>索引| index| 用于提高查询性能，相当于书的目录<br>函数|function|用于完成一次特定的计算，具有一个返回值<br>存储过程|procedure|用于完成一次完整的业务处理，没有返回值，但可以通过传出参数将多个值传给调用环境<br>触发器|trigger|相当于一个事件监听器，当数据库发生特定事件后，触发器触发，完成相应的处理</p>
<h3 id="创建表的语法"><a href="#创建表的语法" class="headerlink" title="创建表的语法"></a>创建表的语法</h3><ul>
<li><code>只需指定该表包含多少列，每列的数据类型信息，无需指定多少行--因为数据库的行是动态的，每条用于保存一条用户数据</code></li>
<li>语法：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">create table [模式名.]表名</span><br><span class="line">(</span><br><span class="line">  #可以有多个列定义</span><br><span class="line">  columnName datatype [default expr]，</span><br><span class="line">  ...</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<ul>
<li>每个列定义之间以英文逗号隔开，<code>最后一个不用</code></li>
<li><code>列定义由列名、列类型和可选默认值组成</code></li>
<li>指定默认值用“default 值”</li>
<li><code>这种建表语句只是创建一个空表，表里没有任何数据</code></li>
<li>MySQL支持的列类型</li>
</ul>
<table>
<thead>
<tr>
<th>列类型</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>tinyint/smallint/mediumint/int(integer)/bigint</td>
<td>1字节/2字节/3字节/4字节/8字节整数，又可分为有无符号两种。这些整数类型区别仅仅是表数范围不同</td>
</tr>
<tr>
<td>float/double</td>
<td>单精度、双精度浮点数</td>
</tr>
<tr>
<td>decimal(dec)</td>
<td>精确小数类型，相当于float double不会产生精度丢失问题,decimal(M,D),指定数M位，其中小数点后D位</td>
</tr>
<tr>
<td>data</td>
<td>日期类型，不能保存时间</td>
</tr>
<tr>
<td>time</td>
<td>时间类型，不能保存日期</td>
</tr>
<tr>
<td>datatime</td>
<td>日期、时间类型</td>
</tr>
<tr>
<td>timestamp</td>
<td>时间戳类型</td>
</tr>
<tr>
<td>year</td>
<td>年类型，仅仅保存时间的年份</td>
</tr>
<tr>
<td>char</td>
<td>定长字符串类型</td>
</tr>
<tr>
<td>varchar</td>
<td>可变长度字符串类型</td>
</tr>
<tr>
<td>binary</td>
<td>定长二进制字符串类型，它以二进制形式保存字符串</td>
</tr>
<tr>
<td>varbinary</td>
<td>可变长度的二进制字符串类型，以二进制形式</td>
</tr>
<tr>
<td>tinyblob/blob/mediumblob/longblob</td>
<td>1字节/2字节/3字节/4字节的二进制大对象，用于存储图片、音乐等二进制数据，分别可存储：255B/64KB/16MB/4GB的大小，区分大小写</td>
</tr>
<tr>
<td>tinytext/text/mediumtext/longtext</td>
<td>1字节/2字节/3字节/4字节文本对象，可用于存储超长长度的字符串，分别可存储255B/64KB/16MB/4GB，不区分大小写</td>
</tr>
<tr>
<td>enmu(‘value1’,’value2’,…)</td>
<td>枚举类型，该列的值只能是enum中多个值的其中一个</td>
</tr>
<tr>
<td>set(‘value1’,’value2’,…)</td>
<td>集合类型，该列的值可以是set后括号中的其中几个</td>
</tr>
<tr>
<td>- 使用子查询建表语句，则可以在建表的同时插入数据</td>
<td></td>
</tr>
</tbody></table>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">create table [模式名.]表名 [colum[,colum...]]</span><br><span class="line">as subquery;</span><br></pre></td></tr></table></figure>
<p>新表中的字段列表必须与子查询中字段列表数量匹配，创建新表时的字段列表可以省略（表示新表的列名与选择结果完全相同）</p>
<h3 id="查看表结构的语法"><a href="#查看表结构的语法" class="headerlink" title="查看表结构的语法"></a>查看表结构的语法</h3><blockquote>
<p><code>describe(desc简写)</code> 表名：显示出一个表</p>
</blockquote>
<blockquote>
<p><code>show create table</code> 表名：显示更详细，包括代码</p>
</blockquote>
<h3 id="修改表结构的语法"><a href="#修改表结构的语法" class="headerlink" title="修改表结构的语法"></a>修改表结构的语法</h3><ul>
<li>修改表结构使用<code>alter table</code>，包括增加列定义、修改列定义、删除列、重命名列等操作<h4 id="增加列定义"><a href="#增加列定义" class="headerlink" title="增加列定义"></a>增加列定义</h4></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">alter table 表名</span><br><span class="line">add</span><br><span class="line">(</span><br><span class="line">   #可以有多个列定义</span><br><span class="line">   column_name1 datatype [default expr] [first|after col_name],</span><br><span class="line">   ...</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>如果只新增一列，可以省略圆括号，在add后紧跟一个列定义即可。</p>
<p><code>字符串值是由单引号引起的</code></p>
<h4 id="修改列定义"><a href="#修改列定义" class="headerlink" title="修改列定义"></a>修改列定义</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">alter table 表名</span><br><span class="line">modify column_name datatype(修改后的类型) [default expr] [first|after col_name](指定需要将目标修改到指定位置）;</span><br></pre></td></tr></table></figure>
<ul>
<li>该修改语句每次只能修改一个列定义</li>
<li>add新增的列名是原表中不存在的，modify修改的是原表中已存在的</li>
<li>first 表示添加在最开始处，after xxx表示添加在xxx之后<h4 id="删除列"><a href="#删除列" class="headerlink" title="删除列"></a>删除列</h4></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">alter table 表名</span><br><span class="line">drop colum_name</span><br></pre></td></tr></table></figure>
<h4 id="重命名数据表"><a href="#重命名数据表" class="headerlink" title="重命名数据表"></a>重命名数据表</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">alter table 表名</span><br><span class="line">rename to 新名</span><br></pre></td></tr></table></figure>
<h4 id="完全改变列定义-change"><a href="#完全改变列定义-change" class="headerlink" title="完全改变列定义 change"></a>完全改变列定义 <code>change</code></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">alter table 表名</span><br><span class="line">change old_column new_column type [default expr][first|after col_name]</span><br></pre></td></tr></table></figure>
<p>一般只有需要修改列名时才会使用change选项</p>
<h3 id="删除表的语法"><a href="#删除表的语法" class="headerlink" title="删除表的语法"></a>删除表的语法</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">drop table 表名</span><br></pre></td></tr></table></figure>
<ul>
<li>表结构被删除，表对象不再存在；</li>
<li>表里所有数据也被删除；</li>
<li>表里所有相关索引，约束也被删除<h3 id="truncate-表"><a href="#truncate-表" class="headerlink" title="truncate 表"></a>truncate 表</h3>作用：<code>删除表里全部数据和结构，在重新建立一个新表（更彻底，无法找回</code><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">truncate 表名</span><br></pre></td></tr></table></figure>
<h2 id="数据库约束"><a href="#数据库约束" class="headerlink" title="数据库约束"></a>数据库约束</h2></li>
<li>约束类型：<blockquote>
<p>NOT NULL：非空约束，指定某列不能为空。</p>
</blockquote>
</li>
</ul>
<blockquote>
<p>UNIQUE：唯一约束，指定某列或者几列组合不能重复。</p>
</blockquote>
<blockquote>
<p>PRIMARY KEY：主键，指定该列的值可以唯一的标识该条记录。</p>
</blockquote>
<blockquote>
<p>POREING KEY：外键，指定该行记录从属于主表中的一条记录，主要用于保证参照完整性。</p>
</blockquote>
<blockquote>
<p>CHECK：检查，指定一个布尔表达式，用于指定对应列的值必需满足该表达式</p>
</blockquote>
<p><code>MySQL不支持CHECK约束，可使用但没卵用</code></p>
<ul>
<li>根据约束对数据列的限制，约束分为如下两类：<blockquote>
<p>单列约束：每个约束只约束一列。</p>
</blockquote>
</li>
</ul>
<blockquote>
<p>多列约束:每个约束可以约束多个数据列。</p>
</blockquote>
<h3 id="NOT-NULL约束"><a href="#NOT-NULL约束" class="headerlink" title="NOT NULL约束"></a>NOT NULL约束</h3><ul>
<li>它只能作为<code>列级约束</code>使用</li>
<li><code>非空约束不能指定名字</code></li>
<li>null值：<blockquote>
<p>所有数据类型的值都可以是null；</p>
</blockquote>
</li>
</ul>
<blockquote>
<p>空字符串不等于null，0也不等于null；</p>
</blockquote>
<blockquote>
<p><code>在数据库中null不等于null</code>；</p>
</blockquote>
<ul>
<li>使用：</li>
</ul>
<ol>
<li>只要在列表定义后添加<code>not null</code>；</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">create table hehe</span><br><span class="line">(</span><br><span class="line">  #建立了非空约束，这意味着hehe_id不可以为null</span><br><span class="line">  hehe_id int not null,</span><br><span class="line">  # MySQL的非空约束不能指定名字</span><br><span class="line">  hehe_name varchar(255) default &apos;xyz&apos; not null,</span><br><span class="line">  #下面列可以为空，默认就是可以为空</span><br><span class="line">  hehe_gender varchar(2) null</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>在使用alter table 修改表时增加或者删除非空约束</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#增加非空约束</span><br><span class="line">alter table hehe</span><br><span class="line">modify hehe_gender varchar(2) not null</span><br><span class="line">#取消非空约束</span><br><span class="line">modify hehe_name varchar(2) null;</span><br><span class="line">#取消非空约束，并指定默认值</span><br><span class="line">alter table hehe</span><br><span class="line">modify hehe_name varchar(255) default &apos;abc&apos; null;</span><br></pre></td></tr></table></figure>
<h3 id="UNIQUE约束"><a href="#UNIQUE约束" class="headerlink" title="UNIQUE约束"></a>UNIQUE约束</h3><ul>
<li>唯一约束用于保证指定列或指定列组合不允许出现重复值，<code>但可以出现多个null</code></li>
<li>当某列创建唯一约束时，会为该列相应的创建唯一索引</li>
<li>如果不给唯一约束起名，该唯一约束默认与列名同名</li>
<li>如果需要为多列建组合约束，或者需要<code>为唯一约束指定约束名</code>，`只能用表级约束语法。</li>
<li>使用：</li>
</ul>
<ol>
<li>列级约束语法：在定义后增加<code>unique</code>关键字即可</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#建表时创建唯一约束，使用列级约束法建立约束</span><br><span class="line">create table unique_test</span><br><span class="line">(</span><br><span class="line">  #建立了非空约束</span><br><span class="line">  test_id int not null,</span><br><span class="line">  #unique是唯一约束，使用列级约束法建立唯一约束</span><br><span class="line">  test_name varchar(255) unique</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>表级约束语法：<code>[constraint 约束名] 约束定义</code></li>
</ol>
<ul>
<li>即可放在create table中，也可放在alter table中使用关键字add来添加约束<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> unique_test2</span><br><span class="line">(</span><br><span class="line">  test_id <span class="built_in">int</span> <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">  test_name <span class="built_in">varchar</span>(<span class="number">255</span>),</span><br><span class="line">  test_pass <span class="built_in">varchar</span>(<span class="number">255</span>),</span><br><span class="line">  <span class="comment">#使用表级约束法语句建立唯一约束</span></span><br><span class="line">  <span class="keyword">unique</span> (test_name),</span><br><span class="line">  <span class="comment">#使用表级约束法建立唯一约束，并指定约束名</span></span><br><span class="line">  <span class="keyword">constraint</span> test2_uk <span class="keyword">unique</span> (test_pass)</span><br><span class="line">  \</span><br><span class="line">  <span class="comment">#使用表级约束法建立唯一约束，指定两列组合不允许重复</span></span><br><span class="line">  <span class="keyword">constraint</span> test3_uk <span class="keyword">unique</span>(test_name,test_pass)</span><br><span class="line">  \</span><br><span class="line">  <span class="comment">#使用add关键字添加唯一约束</span></span><br><span class="line">  <span class="keyword">add</span> <span class="keyword">unique</span>(test_name,test_pass),</span><br><span class="line">);</span><br></pre></td></tr></table></figure></li>
<li>在修改表结构时使用add关键字添加唯一约束</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">alter table unique_test3</span><br><span class="line">add unique(test_name,test_pass);</span><br></pre></td></tr></table></figure>
<p>3.在修改表时使用modify关键字，为单列采用列级约束语法来增加唯一约束</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">alter table unique_test3</span><br><span class="line">modify test_name verchar(255) unique;</span><br></pre></td></tr></table></figure>
<p>5.删除约束：<code>drop index 约束名</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">alter table unique_test3</span><br><span class="line">drop index text3_uk;</span><br></pre></td></tr></table></figure>
<h3 id="PRIMARY-KEY约束"><a href="#PRIMARY-KEY约束" class="headerlink" title="PRIMARY KEY约束"></a>PRIMARY KEY约束</h3><ul>
<li><p><code>主键约束相当于非空约束和唯一约束</code></p>
</li>
<li><p>主键列的值可用于唯一的标识表中的一条记录</p>
</li>
<li><p><code>每一个表中最多允许有一个主键</code>，主键是表中能唯一确定一行记录的字段或字段组合</p>
</li>
<li><p>不管用户是否为主键约束指定约束名，MySQL总是将所有的主键约束命名为PRIMARY</p>
</li>
<li><p>MySQL在主键约束所在列或列组合上建立对应的唯一索引</p>
</li>
<li><p>使用：<code>primary key</code></p>
<p>1.列级约束法 </p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">create table primary_test</span><br><span class="line">(</span><br><span class="line">  #建立了主键约束</span><br><span class="line">  test_id int primary key,</span><br><span class="line">  test_name varchar(255)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p>2.表级约束法:<code>[constraint 约束名]</code> 约束定义</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">create table primary_test2</span><br><span class="line">(</span><br><span class="line">  test_id int not null,</span><br><span class="line">  test_name varchar(255),</span><br><span class="line">  teat_pass varchar(255),</span><br><span class="line">  #指定约束名对MySQL无效</span><br><span class="line">  constraint test_pk primary key (test_id)</span><br><span class="line">  \</span><br><span class="line">  #建立多列组合的主键约束</span><br><span class="line">  primary key (test_name,test_pass)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">alter table primary_test3</span><br><span class="line">modify test_nama varchar(255) primary key;</span><br></pre></td></tr></table></figure>
<p>3.删除指定表的主键约束：<code>drop primary key</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">alter table primary_test3</span><br><span class="line">drop primary key;</span><br><span class="line">\</span><br><span class="line">drop primary key (test_name,test_pass);</span><br></pre></td></tr></table></figure>
<ol start="4">
<li>自增长特性：<code>auto_increment</code></li>
</ol>
<ul>
<li>如果某个数据列的类型是整形，而且该列作为主键列，可指定该列具有自增长功能。</li>
<li>该功能通常用于设置逻辑主键列–该列的值没有任何物理意义，仅仅用于表示每行记录</li>
<li>一旦指定了某列具有自增长特性，则向该表插入记录时可不为该列指定值，由数据库系统自动生成<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">create table primary_test4</span><br><span class="line">(</span><br><span class="line">  #建立主键约束，使用自增长</span><br><span class="line">  test_id int auto_increment primary key,</span><br><span class="line">  test_name varchar(255),</span><br><span class="line">  test_pass varchar(255)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<h3 id="FOREIGN-KEY约束"><a href="#FOREIGN-KEY约束" class="headerlink" title="FOREIGN KEY约束"></a>FOREIGN KEY约束</h3></li>
<li>外键约束主要用于保证一个或两个数据表之间的参考完整性，外键是构建于一个表的两个字段或者两个表的字段之间的参照关系：<code>子（从）表外键列的值必须在主表被参照列的值范围之内，或者为空。</code></li>
<li>当主表的记录被从表记录参照后，必须先把从表里参照记录的所有记录全部删除后，才可以删除主表的该记录或者删除主表记录时级联删除从表所有参照该记录的从表记录</li>
<li><code>从表外键参照的只能是主表主键列或者唯一键列。同一个表中可以拥有多个外键。</code></li>
<li>对于一对多的关联关系，<code>通常在多的一端增加外键列</code></li>
<li>增加外键列的表被称为从表</li>
<li>使用：<code>references</code></li>
</ul>
<ol>
<li>列级约束语法(MySQL建立的列级约束语法不会生效)</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#为保证从表参照的主表存在，通常应该先建主表</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> teacher_table</span><br><span class="line">(</span><br><span class="line">  <span class="comment">#auto_increment:代表数据库的自动编码策略，通常用作数据表的逻辑主键</span></span><br><span class="line">  teacher_id <span class="built_in">int</span> auto_increment,</span><br><span class="line">  teacher_name <span class="built_in">varchar</span>(<span class="number">255</span>)，</span><br><span class="line">  primary <span class="keyword">key</span>(teacher_id)</span><br><span class="line">)；</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> student_table</span><br><span class="line">(</span><br><span class="line">  <span class="comment">#为本表建立主键约束</span></span><br><span class="line">  student_id <span class="built_in">int</span> auto_increment primary <span class="keyword">key</span>,</span><br><span class="line">  student_name <span class="built_in">varchar</span>(<span class="number">255</span>),</span><br><span class="line">  <span class="comment">#指定java_teacher参照到teacher_table的teacher_id列</span></span><br><span class="line">  java_teacher <span class="built_in">int</span> <span class="keyword">references</span> teacher_table(teacher_id)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>表级约束语法：<code>foreign key</code><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#为保证从表参照的主表存在，通常应该先建主表</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> teacher_table1</span><br><span class="line">(</span><br><span class="line">  <span class="comment">#auto_increment:代表数据库的自动编码策略，通常用作数据表的逻辑主键</span></span><br><span class="line">  teacher_id <span class="built_in">int</span> auto_increment,</span><br><span class="line">  teacher_name <span class="built_in">varchar</span>(<span class="number">255</span>)，</span><br><span class="line">  primary <span class="keyword">key</span>(teacher_id)</span><br><span class="line">)；</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> student_table</span><br><span class="line">(</span><br><span class="line">  <span class="comment">#为本表建立主键约束</span></span><br><span class="line">  student_id <span class="built_in">int</span> auto_increment primary <span class="keyword">key</span>,</span><br><span class="line">  student_name <span class="built_in">varchar</span>(<span class="number">255</span>),</span><br><span class="line">  <span class="comment">#指定java_teacher参照到teacher_table的teacher_id列</span></span><br><span class="line"> <span class="keyword">foreign</span> <span class="keyword">key</span> (java_teacher) <span class="keyword">references</span> teacher_table1(teacher_id)</span><br><span class="line">);</span><br></pre></td></tr></table></figure></li>
</ol>
<ul>
<li>使用表级约束语法可以为外键约束指定约束名，如果没有，MySQL会为该键命名为table_name_ibfk //table是从表的表名，而n从1开始的整数</li>
<li>如果需要建立多列组合的外键约束，必须使用表级约束法<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#为保证从表参照的主表存在，通常应该先建主表</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> teacher_table3</span><br><span class="line">(</span><br><span class="line">  <span class="comment">#auto_increment:代表数据库的自动编码策略，通常用作数据表的逻辑主键</span></span><br><span class="line">  teacher_pass <span class="built_in">varchar</span>(<span class="number">255</span>),</span><br><span class="line">  teacher_name <span class="built_in">varchar</span>(<span class="number">255</span>)，</span><br><span class="line">  primary <span class="keyword">key</span>(teacher_name,teacher_pass)</span><br><span class="line">)；</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> student_table3</span><br><span class="line">(</span><br><span class="line">  <span class="comment">#为本表建立主键约束</span></span><br><span class="line">  student_id <span class="built_in">int</span> auto_increment primary <span class="keyword">key</span>,</span><br><span class="line">  student_name <span class="built_in">varchar</span>(<span class="number">255</span>),</span><br><span class="line">  java_teacher_name <span class="built_in">varchar</span>(<span class="number">255</span>),</span><br><span class="line">  java_teacher_pass <span class="built_in">varchar</span>(<span class="number">255</span>),</span><br><span class="line">  <span class="comment">#指定两列的联合外键</span></span><br><span class="line">  <span class="keyword">foreign</span> <span class="keyword">key</span> (java_teacher_name,java_teacher_pass) <span class="keyword">references</span> teacher_table3(teacher_name,teacher_pass)</span><br><span class="line">);</span><br></pre></td></tr></table></figure></li>
</ul>
<ol start="3">
<li>显示指定外键约束的名字，可使用<code>constraint</code>来指定名字<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#为保证从表参照的主表存在，通常应该先建主表</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> teacher_table2</span><br><span class="line">(</span><br><span class="line">  <span class="comment">#auto_increment:代表数据库的自动编码策略，通常用作数据表的逻辑主键</span></span><br><span class="line">  teacher_id <span class="built_in">int</span> auto_increment,</span><br><span class="line">  teacher_name <span class="built_in">varchar</span>(<span class="number">255</span>)，</span><br><span class="line">  primary <span class="keyword">key</span>(teacher_id)</span><br><span class="line">)；</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> student_table2</span><br><span class="line">(</span><br><span class="line">  <span class="comment">#为本表建立主键约束</span></span><br><span class="line">  student_id <span class="built_in">int</span> auto_increment primary <span class="keyword">key</span>,</span><br><span class="line">  student_name <span class="built_in">varchar</span>(<span class="number">255</span>),</span><br><span class="line">  java_teacher <span class="built_in">int</span>,</span><br><span class="line">  <span class="comment">#指定java_teacher参照到teacher_table的teacher_id列，并指定外键约束名为student_teacher_fk</span></span><br><span class="line"> <span class="keyword">constraint</span> student_teacher_fk <span class="keyword">foreign</span> <span class="keyword">key</span> (java_teacher) <span class="keyword">references</span> teacher_table2(teacher_id)</span><br><span class="line">);</span><br></pre></td></tr></table></figure></li>
<li>删除外键约束：<code>alter table后加 drop foreign key 约束名</code><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#删除student_table3表上名为student_table3_ibfk_1的外键约束</span><br><span class="line">alter table student_table3</span><br><span class="line">drop foreign key student_tables3_ibfk_1;</span><br></pre></td></tr></table></figure></li>
<li>增加外键约束：<code>add foreign key</code><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> student_table3</span><br><span class="line"><span class="keyword">add</span> <span class="keyword">foreign</span> <span class="keyword">key</span>(java_teacher_name,java_teacher_pass) <span class="keyword">references</span> teacher_table3(teacher_name,teacher_pass);</span><br></pre></td></tr></table></figure></li>
<li>自关联：参照自身<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">creater table foreign_test</span><br><span class="line">(</span><br><span class="line">  foreign_id int auto_increment primary key,</span><br><span class="line">  foreign_name varchar(255),</span><br><span class="line">  refer_id int,</span><br><span class="line">  foreign key(refer_id) references foreign_test(foreign_id)</span><br><span class="line">)</span><br></pre></td></tr></table></figure></li>
<li>删除主表记录：</li>
</ol>
<ul>
<li><code>on delete cascade</code>:删除主表记录时，把参照该主表记录的从表记录全部联级删除</li>
<li><code>on delete set null</code>：删除主表记录时，把参照该主表记录的从表记录的外键设为null</li>
<li>在建立外键约束后添加<h2 id="索引"><a href="#索引" class="headerlink" title="索引"></a>索引</h2></li>
<li>索引是一个数据库对象，从属于数据表</li>
<li>作用：加快对表的查询</li>
<li>索引在数据字典中独立存在，但不能独立存在，<code>必须属于某个表</code></li>
<li>创建索引：<blockquote>
<p>自动：当在表上定义<code>主键约束、唯一约束和外键约束</code>时，系统会为该数据自动创建对应的索引</p>
</blockquote>
</li>
</ul>
<blockquote>
<p>手动：用户可以通过<code>create index</code>语句来创建索引</p>
</blockquote>
<ul>
<li>删除索引：<blockquote>
<p>自动：数据表被删除时，该表上的索引自动被删除</p>
</blockquote>
</li>
</ul>
<blockquote>
<p>手动：通过<code>drop index</code>语句来删除指定数据表上的指定索引</p>
</blockquote>
<ul>
<li>一个表中可以有多个索引列，每个索引都可用于加速该列的查询速度</li>
<li>语法：</li>
</ul>
<ol>
<li>创建索引：</li>
</ol>
<ul>
<li>在创建表时创建索引：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">creat table 表名</span><br><span class="line">(</span><br><span class="line">    字段1，字段2... </span><br><span class="line">    [unique]index [索引别名](列名)；//默认与列名相同</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
 加<code>unique</code>限定索引的值必须是唯一的</li>
<li>在已存在的表上创建索引</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">create (unique)index index_name</span><br><span class="line">on table_name (column[,column]...);</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#提高employees基于last_name字段的查询速度</span><br><span class="line">create index exm_last_name_idx</span><br><span class="line">on emoployees (last_name);</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#同时对多列建立索引</span><br><span class="line">create index emp_last_name_idx2</span><br><span class="line">on employees(first_name , last_name);</span><br></pre></td></tr></table></figure>
<ul>
<li>使用alter table创建索引<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">alter table 表名</span><br><span class="line">add [unique] index [索引名] [列名]；</span><br></pre></td></tr></table></figure></li>
</ul>
<ol start="2">
<li>删除索引<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">drop index 索引名 on 表名</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#删除了employees表上的emp_last_name_idx2索引</span><br><span class="line">drop index emp_last_name_idx2</span><br><span class="line">on employees</span><br></pre></td></tr></table></figure>
<h2 id="视图"><a href="#视图" class="headerlink" title="视图"></a>视图</h2></li>
</ol>
<ul>
<li>视图是一个或多个数据表中数据的逻辑显示，<code>并不能存储数据</code></li>
<li>视图只是数据表的逻辑显示，也就是一个<code>查询结果</code></li>
<li>语法：</li>
</ul>
<ol>
<li>创建/修改视图</li>
</ol>
<ul>
<li><code>create or replace</code><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#如果指定视图名不存在，则创建视图；如果指定视图名已经存在，则使用新视图替换原有视图</span><br><span class="line">create or replace view 视图名</span><br><span class="line">as select</span><br><span class="line">subquery</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">create or replace view view_test[(a,b)]//创建字段别名</span><br><span class="line">as</span><br><span class="line">select teacher_name,teacher_pass from teacher_table;</span><br></pre></td></tr></table></figure></li>
<li><code>alter view 视图名</code><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">alter view 视图名</span><br><span class="line">as select 语句</span><br></pre></td></tr></table></figure>
<blockquote>
<p>使用<code>with check option</code>子句创建的视图不允许修改</p>
</blockquote>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">create or replace view view_test</span><br><span class="line">as</span><br><span class="line">select teache_name  from teacher_table</span><br><span class="line">#指定不允许修改该视图数据</span><br><span class="line">with check option；</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>删除视图：<code>drop view</code> 视图名；</li>
<li>查看视图：</li>
</ol>
<ul>
<li><code>describe(desc) 视图名</code>：查看基本信息</li>
<li><code>show table status like 视图名</code>：查看基本属性（基本都为null）</li>
<li><code>show create view 表名</code>：详细信息，包括建视图语句</li>
</ul>
<ol start="4">
<li>更新视图：DML语句<h2 id="DML语句：操作数据表里的数据"><a href="#DML语句：操作数据表里的数据" class="headerlink" title="DML语句：操作数据表里的数据"></a>DML语句：<code>操作数据表里的数据</code></h2><blockquote>
<p>插入新数据</p>
</blockquote>
</li>
</ol>
<blockquote>
<p>修改已有数据</p>
</blockquote>
<blockquote>
<p>删除不需要的数据</p>
</blockquote>
<ul>
<li>DML语句由<code>insert into、update和delete from</code>三个命令组成</li>
</ul>
<ol>
<li><code>insert into语句</code></li>
</ol>
<ul>
<li>用于向指定数据表中插入记录，每次只能插入一条</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> table_name[(<span class="keyword">column</span> [,column...])]</span><br><span class="line"><span class="keyword">values</span>(<span class="keyword">value</span> [,value...]); <span class="comment">#字符串使用单引号</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>表名后用括号列出所有需要插入值的列名，而values后用括号列出对应需要插入的值</p>
</blockquote>
<blockquote>
<p>如果省略表名后面的括号及括号里的列名列表，默认将为所有列插入值，则需要为每一列都指定一个值，也可以为无法确定的值的列分配null</p>
</blockquote>
<blockquote>
<p>只有在数据库中已经成功创建了数据表之后，才可以向数据表中插入记录</p>
</blockquote>
<blockquote>
<p>外键列的值必须是被参照列里已有的值，所以向从表中插入记录之前，通常应该先向主表中插入记录，否则从表记录的外键列只能为null</p>
</blockquote>
<blockquote>
<p>外键约束保证被参照的记录必须存在，但并不保证必须有被参照记录，即<code>外键列可以为null</code></p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">insert into teacher_table2(teacher_name)</span><br><span class="line">values(&apos;xyz&apos;);</span><br><span class="line"></span><br><span class="line">insert into teacher_table2</span><br><span class="line">#使用null代替主键列的值</span><br><span class="line">values(null,&apos;abc&apos;);</span><br></pre></td></tr></table></figure>
<ul>
<li>带子查询的插入语句：可以一次插入多条记录<blockquote>
<p>只要求选择出的数据和插入目的表的数据列个数相等、数据类型匹配</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">insert into student_table2(student_name)</span><br><span class="line">#用带子查询的值来插入</span><br><span class="line">select teacher_name from teacher_table2;</span><br></pre></td></tr></table></figure></li>
<li>拓展语法：可以一次性插入多条记录，在values后使用多个括号包含多条记录，表示多条记录的多个括号之间以英文逗号（，）隔开<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">insert into teacher_table2</span><br><span class="line">#同时插入多个值</span><br><span class="line">values(null,&quot;Yeeku&quot;),</span><br><span class="line">(null,&quot;Sharfly&quot;);</span><br></pre></td></tr></table></figure></li>
</ul>
<ol start="2">
<li><code>update set语句</code></li>
</ol>
<ul>
<li>用于修改数据表的记录，每次可以修改多条记录，通过使用<code>where子句限定修改哪些记录</code></li>
<li>where与if类似，没有where的句子总为true，即该表所有记录都会被修改<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">update table_name</span><br><span class="line">set column1=value1[,column2=value2]...</span><br><span class="line">[where condition];</span><br></pre></td></tr></table></figure></li>
<li>update语句还可以一次修改多列，通过<code>set关键字后使用column1=value1，column2=value2...来实现，修改多列的值之间用英文逗号隔开</code><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#把teacher_table2表中所有的teacher_name列的值改为’孙悟空‘</span><br><span class="line">update teacher_table2</span><br><span class="line">set teacher_name=&apos;孙悟空&apos;；</span><br><span class="line"></span><br><span class="line">#通过where条件来指定只修改特定记录</span><br><span class="line">update teacher_table2</span><br><span class="line">set teacher_name=&apos;猪八戒&apos;</span><br><span class="line">where teacher_id&gt;1;</span><br></pre></td></tr></table></figure></li>
</ul>
<ol start="3">
<li><code>delete from语句</code></li>
</ol>
<ul>
<li>用于删除指定数据表记录，使用时不需要指定列名，因为总是整行地删除</li>
<li>可使用where</li>
<li>格式语法<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">delete from table_name</span><br><span class="line">[where condition];</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#把student_table2表中的记录全部删除</span><br><span class="line">delete from student_table2;</span><br><span class="line"></span><br><span class="line">#使用where限定只删除指定记录，可以加上limit限制每次删除数量</span><br><span class="line">delete from teacher_table2</span><br><span class="line">where teache_id &gt;2 limit 1;</span><br></pre></td></tr></table></figure></li>
<li>只有先将从表中参照主表记录的所有记录全部删除后，才能删除主表记录<h2 id="单表查询"><a href="#单表查询" class="headerlink" title="单表查询"></a>单表查询</h2></li>
<li><code>select语句</code>：用于从一个或者多个数据表中选出特定的行、列的交集</li>
<li>语法格式：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select coulmu1,column2...</span><br><span class="line">from 数据源</span><br><span class="line">[where condition]</span><br></pre></td></tr></table></figure>
<blockquote>
<p>数据源可以是表、视图等；如果没有where条件，默认选出所有行；<code>如果想选出所有列，则可使用带星号(*)代表所有列</code>；</p>
</blockquote>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select *</span><br><span class="line">from teacher_table;</span><br></pre></td></tr></table></figure>
<ul>
<li>select语句可使用算数运算符（+、-、*、/）<blockquote>
<p>不仅可以在列和常量、变量之间进行运算，<code>也可以在两列之间进行运算</code>。</p>
</blockquote>
</li>
</ul>
<blockquote>
<p>数据列很像一个变量，但其值具有指定的范围，因此能使用变量的地方，基本上都可以使用数据列。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">select teacher_id +5</span><br><span class="line">from teacher_table;</span><br><span class="line"></span><br><span class="line">#查询出teacher_table表中teacher_id*3大于4的记录</span><br><span class="line">select *</span><br><span class="line">from teacher_table</span><br><span class="line">where teacher_id*3&gt;4;</span><br><span class="line"></span><br><span class="line"># 数据列实际上可当成一个变量</span><br><span class="line">select 3*5，,20</span><br><span class="line">from teacher_table;</span><br></pre></td></tr></table></figure>
<ul>
<li>MySQL使用<code>concat函数来进行字符串连接运算</code><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#选择出teacher_name和&apos;xxx&apos;字符串连接后的结果</span><br><span class="line">select concat(teacher_name,&apos;xxx&apos;)</span><br><span class="line">from teacher_table;</span><br></pre></td></tr></table></figure>
<code>如果让字符串和null进行连接运算，将使整个算数表达式的返回值为null</code></li>
<li>可以为数据列或者表达式起一个别名，<code>别名紧跟数据列，中间以空格隔开，或者使用as关键字隔开</code><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> teacher_id +<span class="number">5</span> <span class="keyword">as</span> MY_ID</span><br><span class="line"><span class="keyword">from</span> teacher_table;</span><br><span class="line"></span><br><span class="line"><span class="comment">#可以用双引号实现别名中的特殊字符</span></span><br><span class="line"><span class="keyword">select</span> teacher_id + <span class="number">5</span> <span class="string">"MY'id"</span></span><br><span class="line"><span class="keyword">from</span> teacher_table;</span><br><span class="line"></span><br><span class="line"><span class="comment">#为多列起名</span></span><br><span class="line"><span class="keyword">select</span> teacher_id +<span class="number">5</span> MY_id,teacher_name 老师名</span><br><span class="line"><span class="keyword">from</span> teacher_table;</span><br><span class="line"></span><br><span class="line"><span class="comment">#为表起别名</span></span><br><span class="line"><span class="keyword">select</span> teacher_id +<span class="number">5</span> </span><br><span class="line"><span class="keyword">from</span> teacher_table t;</span><br><span class="line"></span><br><span class="line"><span class="comment">#运算符在多列之间进行运算</span></span><br><span class="line"><span class="keyword">select</span> teacher_id +<span class="number">5</span> MY_ID,<span class="keyword">concat</span>(teacher_name,teacher_id) teacher_name</span><br><span class="line"><span class="keyword">from</span> teacher_table</span><br><span class="line"><span class="keyword">where</span> teacher_id *<span class="number">2</span>&gt;<span class="number">3</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="number">5</span>+<span class="number">4</span></span><br><span class="line"><span class="keyword">from</span> teacher_table</span><br><span class="line"><span class="keyword">where</span> <span class="number">2</span>&lt;<span class="number">9</span>;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>SQL会把常量当成一列，对于上面最后的语句，有多少条语句该常量就出现多少次</p>
</blockquote>
</li>
</ul>
<blockquote>
<p>select 5+4 from dual;dual没有任何意义，仅仅相当于from后面的占位符</p>
</blockquote>
<ul>
<li><p>select会默认把所有符合条件的记录全部选出来，即使两行记录完全一样。可以使用<code>distinct关键字从查询结果中清除重复行。</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select distinct student_name,java_teacher</span><br><span class="line">from student_table;</span><br></pre></td></tr></table></figure>
<blockquote>
<p> <code>distinct紧跟select关键字，它的作用是去除后面字段组合的重复值，而不管对应记录在数据库里是否重复</code>，例如：(1,’a’,’b’)和(2,’a’,’b’)两条记录在数据库里是不重复的，但如果仅选择后面两列，则distinct会认为两条记录重复</p>
</blockquote>
</li>
<li><p>运算符：SQL中判断两个值是否相等的<code>比较运算符是单等号，赋值运算符是冒号等号(:=)</code></p>
</li>
<li><p>特殊的比较运算符</p>
</li>
</ul>
<table>
<thead>
<tr>
<th>运算符</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>expr1 (not) between expr2 and expr3</td>
<td>expr1的值在两者之间</td>
</tr>
<tr>
<td>expr1 <code>in</code>(expr2,expr3,…)</td>
<td>expr1的值等于后面括号中的任意一个</td>
</tr>
<tr>
<td>like</td>
<td>查询与like后的字符串匹配的字符串</td>
</tr>
<tr>
<td>is (not) null</td>
<td>要求指定值等于null</td>
</tr>
<tr>
<td><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">select * from student_table</span><br><span class="line">where student_id between 2 and 4;</span><br><span class="line"></span><br><span class="line">#选出java_teacher&lt;=2，student_id&gt;=2的所有记录</span><br><span class="line">select * from student_table</span><br><span class="line">whrer 2 between java_teacher and student_id;</span><br><span class="line"></span><br><span class="line">#选出student_id 为2或4的所有记录</span><br><span class="line">select * from student_table</span><br><span class="line">where student_id in (2,4);</span><br><span class="line">/</span><br><span class="line">where 2 in (student_id,java_teacher);</span><br></pre></td></tr></table></figure></td>
<td></td>
</tr>
<tr>
<td>&gt; like 后面可以加两个通配符：<code>下划线(_):代表一个任意字符；百分号(%):代表任意多个字符。</code></td>
<td></td>
</tr>
</tbody></table>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">where student_name like &apos;孙%&apos;；</span><br><span class="line">where student_name like &apos;__&apos;；//用两个下划线代表两个字符</span><br></pre></td></tr></table></figure>
<blockquote>
<p><code>MySQL使用\作为转义字符</code>；标准SQL语句没有转义字符，而是使用escape关键字显示进行转义</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#选出所有名字以下划线开头的学生</span><br><span class="line">select * from student_table</span><br><span class="line">where student_name like &apos;\_%&apos;;</span><br><span class="line"></span><br><span class="line">select * from student_table</span><br><span class="line">where student_name like &apos;\_%&apos; escape &apos;\&apos;;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>where student_name is null;#选择出student_name为null的所有记录。</p>
</blockquote>
<ul>
<li>逻辑运算符：<code>and、or和not</code><blockquote>
<p>优先级：<code>所有比较运算符&gt;not&gt;and&gt;or</code></p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">where student_name like &apos;__&apos; and(or) student_id &gt;3;</span><br><span class="line">where not student_name like &apos;\_%&apos;;</span><br></pre></td></tr></table></figure></li>
<li>执行查询后的查询顺序默认按照插入顺序排列，使用<code>order by 子句，默认按升序排列</code>；若需要<code>强制降序排列，则需要在列名后使用desc关键字</code><blockquote>
<p>order by column_name1 [desc] , column_name2 …</p>
</blockquote>
</li>
</ul>
<blockquote>
<p>如果按多列排序，每列的asc，desc必须单独设定。如果指定了多个拍序列，只有<code>当第一列中存在多个相同值时，第二个排序列才会起作用</code></p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#按java_teacher列降序排序，当java_teacher列的值相同时按student_name列的升序排列</span><br><span class="line">select * from student_table</span><br><span class="line">order by java_teacher desc， student_name;</span><br></pre></td></tr></table></figure>
<h3 id="group-by分组查询"><a href="#group-by分组查询" class="headerlink" title="group by分组查询"></a>group by分组查询</h3><ul>
<li>表达式：<blockquote>
<p>group by 属性名 [having表达式] [with rollup]</p>
</blockquote>
</li>
</ul>
<ol>
<li>单独使用，只会列出第一个出现的值<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#只会筛选出第一个出现GradeName1的student的数据</span><br><span class="line">select * from t_student group by gradeName;</span><br></pre></td></tr></table></figure></li>
<li>与group concat()函数一起使用：会把所有值列出来<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#会把所有属于gradeName的studentName全部组合在一起列出来</span><br><span class="line">select gradeName,group concat(studentName) from t_student  group by gradeName;</span><br></pre></td></tr></table></figure></li>
<li>与聚合函数一起使用</li>
<li>与having一起使用，限制输出结果<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#只会输出学生名字多于三个的年级及学生名字</span><br><span class="line">select gradeName,group concat(studentName) from t_student  group by gradeName having count(studentName) &gt;3;</span><br></pre></td></tr></table></figure></li>
<li>与 with rollup一起使用，在最后一行增加一个叠加总和<h3 id="limit-分页查询"><a href="#limit-分页查询" class="headerlink" title="limit 分页查询"></a>limit 分页查询</h3><blockquote>
<p><code>select 字段1，字段2 ...from 表名 limit 初始位置，记录数</code></p>
</blockquote>
</li>
</ol>
<blockquote>
<p><code>第一条记录从0开始</code></p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#输出从第一条开始的五条记录；</span><br><span class="line">select * from t_student limit 0,5;</span><br></pre></td></tr></table></figure>
<h2 id="数据库函数"><a href="#数据库函数" class="headerlink" title="数据库函数"></a>数据库函数</h2><ul>
<li>可分为单行函数和多行函数<blockquote>
<p>单行函数：对单行输入单独计算，每行得到一个计算结果返回给用户。其参数可以是变量、常量或数据列；可以接收多个参数，但只返回一个值；单行函数可以改变参数的数据类型</p>
</blockquote>
</li>
</ul>
<blockquote>
<p>多行函数：多行输入整体处理，只返回一个值</p>
</blockquote>
<ul>
<li><code>MySQL单行函数的用法</code>：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">#选出teacher_table表中teacher_name列的字符长度</span><br><span class="line">select char_length(teacher_name)</span><br><span class="line">from teacher_table;</span><br><span class="line"></span><br><span class="line">#求绝对值</span><br><span class="line">select abs(x);</span><br><span class="line"></span><br><span class="line">#求平方根</span><br><span class="line">sqrt(x);</span><br><span class="line"></span><br><span class="line">#求余</span><br><span class="line">mod(x,y);</span><br><span class="line"></span><br><span class="line">#计算teacher_name列字符长度的sin值</span><br><span class="line">select sin(char_length(teacher_name))</span><br><span class="line">from teacher_table;</span><br><span class="line"></span><br><span class="line">#计算1.57的sin值</span><br><span class="line">select sin(1.57);</span><br><span class="line"></span><br><span class="line">#为指定日期添加一定时间</span><br><span class="line">#在这种语法下interval是关键字，需要一个数值，还需要一个单位</span><br><span class="line">SELECT DATA_ADD(&apos;2018-04-01&apos;,interval 2 MOMTH)；</span><br><span class="line">#简单用法</span><br><span class="line">select ADDDATE(&apos;2018-04-01&apos;,3);</span><br><span class="line"></span><br><span class="line"># 获取当前日期</span><br><span class="line">select CURDATE();</span><br><span class="line"></span><br><span class="line">#获取当前时间</span><br><span class="line">select curtime();</span><br><span class="line"></span><br><span class="line">#返回日期d中的月份</span><br><span class="line">select month(d);</span><br></pre></td></tr></table></figure>
<h4 id="连接函数"><a href="#连接函数" class="headerlink" title="连接函数"></a>连接函数</h4><blockquote>
<p><code>CONCAT(a,b)</code>:用于把两个字符串连接起来</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT CONCAT(firstname,lastname) from Table;</span><br></pre></td></tr></table></figure>
<blockquote>
<p><code>CONCAT_WS</code>(‘(任意的分隔符)’,firstname,lastname):在两者之间显示分隔符</p>
</blockquote>
</li>
</ul>
<h4 id="截断和填充函数"><a href="#截断和填充函数" class="headerlink" title="截断和填充函数"></a>截断和填充函数</h4><ul>
<li><code>RTRIM/LTRIM</code>:从一个字符串的右端或者左端删除空格</li>
<li><code>TRIM</code>:删除想要剔除的字符，使用<code>LEADING TAILING</code>分别表示剔除开头的或末尾的，若没有则默认两边都剔除<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT TRIM(LEADING &apos;X&apos; FROM &apos;XXXneedleXXX&apos;);//显示needleXXX</span><br><span class="line">SELECT TRIM(TAILING &apos;X&apos; FROM &apos;XXXneedleXXX&apos;);//显示XXXneedle</span><br><span class="line">SELECT TRIM(&apos;X&apos; FROM &apos;XXXneedleXXX&apos;);//显示needle</span><br></pre></td></tr></table></figure></li>
<li><code>RPAD()/LPAD()</code>:向一个字符串中添加字符<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT RPAD(&apos;needle&apos;,10,&apos;X&apos;);//添加直到字符串达到10个字符的长度</span><br></pre></td></tr></table></figure>
<h4 id="定位和位置函数"><a href="#定位和位置函数" class="headerlink" title="定位和位置函数"></a>定位和位置函数</h4></li>
<li><code>LICATE(&#39;A&#39;,&#39;B&#39;)</code>:返回A中某个字符串在B中第一次出现的位置（从1开始，不从0开始）<h4 id="子字符串函数"><a href="#子字符串函数" class="headerlink" title="子字符串函数"></a>子字符串函数</h4></li>
<li><code>SUBSTRING(&quot;字符串&quot;,2,3)</code>：获取第2个开始的三个字符</li>
<li><code>LEFT/RIGHT(&#39;MySQL&#39;,3)</code>:获取字符串左边或右边的三个字符<h4 id="字符串修改函数"><a href="#字符串修改函数" class="headerlink" title="字符串修改函数"></a>字符串修改函数</h4></li>
<li><code>LCASE/UCASE()</code>:把字符串转化为小写或者大写，参数为列名便是这个列的所有值转化为小写/大写</li>
<li><code>REPEAT(&quot;A&quot;,&quot;B&quot;,&quot;C&quot;)</code>:把A字符串中的B全部转化为C<h4 id="加密函数"><a href="#加密函数" class="headerlink" title="加密函数"></a>加密函数</h4><blockquote>
<p><code>password(str)</code>:一般对用户的密码加密，不可解密</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">insert into 表名 values(值1，值2，...,password(&apos;字符&apos;),...)；</span><br></pre></td></tr></table></figure>
<blockquote>
<p><code>sha()</code>：用于对密码加密，不可解密，会把一段文字加密为唯一的40字符编码</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">insert into 表名 values (值1，值2，...,sha(&apos;字符&apos;),...);</span><br></pre></td></tr></table></figure>
<blockquote>
<p><code>md5(str)</code>:普通加密，不可解密</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">insert into 表名  values (值1，值2，...,password(&apos;字符&apos;),...)；</span><br></pre></td></tr></table></figure>
<blockquote>
<p><code>encode(str,pswd_str)</code>:加密函数，结果是一个二进制数，必须使用blob类型的字段来保存它，<code>可解密</code></p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">insert into 表名  values (值1，值2，...,encode(&apos;字符&apos;,&apos;xx&apos;),...)；//&apos;xx&apos;为某个解密钥匙标记</span><br></pre></td></tr></table></figure>
<blockquote>
<p><code>decode(crypt_str,pswd_str)</code>:解密函数</p>
</blockquote>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select decode(&quot;被加密数据&quot;，&quot;与被加密参数对应的钥匙标记&quot;) from 表名；</span><br></pre></td></tr></table></figure>
<ul>
<li>MySQL提供如下几个处理null的函数<blockquote>
<p>使用：<code>select 函数名 from 表名</code></p>
</blockquote>
</li>
</ul>
<blockquote>
<p>ifnull(expr1,expr2):如果expr1为null，则返回expr2，否则返回expr1</p>
</blockquote>
<blockquote>
<p>nullif(expr1,expr2):如果expr1和expr2相等，则返回null，否则返回expr1</p>
</blockquote>
<p>if(expr1,expr2,expr3):如果expr1为true，不等于0，且不等于null，则返回expr2，否则返会expr3</p>
<blockquote>
<p>isnull(expr1):判断expr1是否为null，如果是则返回true，否则返回false</p>
</blockquote>
<ul>
<li>case函数：流程控制函数<blockquote>
<p><code>select 列名 ，case用法 from 表名；</code></p>
</blockquote>
</li>
</ul>
<ol>
<li>用法1：<blockquote>
<p>用value依次与后面的compare_value1等相比较，如果value与指定的compare_value相等，则返回对应的result，否则返回else的result </p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">case value</span><br><span class="line">when compare_value1 then result1</span><br><span class="line">when compare_value2 then result2</span><br><span class="line">...</span><br><span class="line">else result</span><br><span class="line">end</span><br></pre></td></tr></table></figure></li>
<li>用法2：<blockquote>
<p>condition内容是一个返回boolean值的条件表达式</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">case</span><br><span class="line">when condition1 then result1</span><br><span class="line">when condition2 then result2</span><br><span class="line">...</span><br><span class="line">else result</span><br><span class="line">end</span><br></pre></td></tr></table></figure>
<h2 id="分组和组函数"><a href="#分组和组函数" class="headerlink" title="分组和组函数"></a>分组和组函数</h2></li>
</ol>
<ul>
<li>组函数就是多行函数，将一组记录作为整体计算，每组记录返回一个结果</li>
<li>常用组函数：<blockquote>
<p>avg([distinct|all]expr):       计算多行expr的平均值，<code>expr可以是变量、常量或者数据列，但其数据类型必须是数值型</code>，如果使用<code>distinct表示不计算重复值</code>，all用与不用一样</p>
</blockquote>
</li>
</ul>
<blockquote>
<p>count({<em>|[distinct|all]expr}): 计算多行expr的总条数，expr的数据类型可以是任意类型；`用（\</em>）表示统计该表内记录的行数`</p>
</blockquote>
<blockquote>
<p>max(expr):计算多行expr的最大值，其中expr其数据类型可以是任意类型</p>
</blockquote>
<blockquote>
<p>min(expr):计算多行expr的最小值</p>
</blockquote>
<blockquote>
<p>sum([distinct|all]expr):计算多行expr的总和，<code>expr的数据类型必须是数值型</code></p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#计算的结果是20*记录的行数</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">sum</span>(<span class="number">20</span>)</span><br><span class="line"><span class="keyword">from</span> student_table;</span><br><span class="line"></span><br><span class="line"><span class="comment">#因为expr的值是34，所以每行的值都相同</span></span><br><span class="line"><span class="comment">#使用distinct强制不计算重复值，所以下面计算结果为34</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">sum</span>(<span class="keyword">distinct</span> <span class="number">34</span>)</span><br><span class="line"><span class="keyword">from</span> student_table;</span><br><span class="line"></span><br><span class="line"><span class="comment">#使用count统计记录行数时，null不会被计算在内</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">count</span>(student_name)</span><br><span class="line"><span class="keyword">from</span> student_table;</span><br><span class="line"></span><br><span class="line"><span class="comment">#对于可能出现null的列，可以用ifnull处理</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">count</span> (<span class="keyword">ifnull</span>(student_name,<span class="number">0</span>))</span><br><span class="line"><span class="keyword">from</span> student_table;</span><br></pre></td></tr></table></figure>
<ul>
<li><code>distinct和*不能同时使用</code></li>
<li><code>组函数会把所有记录当成一组</code>，为了对记录进行显示分组，可以在select语句后使用<code>group by 子句</code>，<code>group by 子句后通常跟一个或多个列名，表名查询结果根据一列或多列进行分组，当一列或多列组合的值完全相同时，系统会把这些记录当成一组</code><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#count(*)将会对每组得到一个结果</span><br><span class="line">select count(*)</span><br><span class="line">from student_table</span><br><span class="line">#将java_teacher列值相同的记录当成一组</span><br><span class="line">group by java_teacher;</span><br></pre></td></tr></table></figure></li>
<li>如果对多列进行分组，则要求多列的值完全相同时才会被当成一组<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">select count(*)</span><br><span class="line">from student_table</span><br><span class="line">#当java_teacher、student_name两列的值完全相同时才会被当成一组</span><br><span class="line">group by java_teacher , student_name;</span><br></pre></td></tr></table></figure></li>
<li>对于很多数据库而言，分组计算时，如果查询列表中使用了组函数，或者select语句中使用了group by分组子句，则要求<code>出现在select列表中的字段，要么使用组函数包起来，要么必须出现在group by子句中</code>。 </li>
<li>对于MySQL：如果某个数据列既没有出现在group by之后，也没有使用组函数包起来，<code>则MySQL会输出该列的第一条记录的值。</code></li>
<li>如果需要对分组进行过滤，则应该<code>使用having子句，子句后面有一个条件表达式，只有满足该表达式的分组才会被选出来</code></li>
<li>where 和 having 的区别<blockquote>
<p><code>不能在where子句中过滤组，where子句仅用于过滤行，过滤组必须使用having子句</code></p>
</blockquote>
</li>
</ul>
<blockquote>
<p>不能在where子句中使用组函数，having子句才可以使用组函数</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">select *</span><br><span class="line">from student_table</span><br><span class="line">group by java_teacher</span><br><span class="line">#对组进行过滤</span><br><span class="line">having count(*)&gt;2;</span><br></pre></td></tr></table></figure>
<h2 id="多表连接查询"><a href="#多表连接查询" class="headerlink" title="多表连接查询"></a>多表连接查询</h2><ul>
<li>需要选择的数据并不是来自一个表，而是来自多个数据表，这就需要使用多表查询</li>
<li>两种查询规范：</li>
</ul>
<ol>
<li>SQL 92规范：<blockquote>
<p>等值查询</p>
</blockquote>
</li>
</ol>
<blockquote>
<p>非等值查询</p>
</blockquote>
<blockquote>
<p>外连接</p>
</blockquote>
<blockquote>
<p>广义笛卡尔积</p>
</blockquote>
<ul>
<li>语法：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select column1, column2 ...</span><br><span class="line">from table1,table2 ...</span><br><span class="line">[where join_condition]</span><br></pre></td></tr></table></figure></li>
<li>多表连接中可能出现两个或多个数据列同名的列名，则需要在这些同名列之前使用表名前缀</li>
<li>等值查询:<code>where中要求两列值相等</code><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select s.*,teacher_name</span><br><span class="line">from student_name s,teacher_table t</span><br><span class="line">where s.java_teacher = t.teacher_id;</span><br></pre></td></tr></table></figure></li>
<li>非等值查询：<code>where中要求两列值不相等</code>，大于或小于</li>
<li>广义笛卡尔积：<code>没有where子句</code>，结果会有n x m条记录</li>
<li>如果要将记录进行过滤，则将过滤条件和连接条件使用and连接起来<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">select s.* ,teacher_name</span><br><span class="line">#指定多个数据表，并指定表别名</span><br><span class="line">from student_table s，teacher_table t</span><br><span class="line">#使用where指定连接条件，并指定student_name 列不能为null</span><br><span class="line">where s.java_teacher=t.teacher_id and student_name is not null;</span><br></pre></td></tr></table></figure></li>
<li>MySQL不支持左外连接和右外连接</li>
<li>自连接：对于自关联的数据表查询<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 定义一个自关联的数据表</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> emp_table</span><br><span class="line">(</span><br><span class="line">   emp_id <span class="built_in">int</span> auto_increment primary <span class="keyword">key</span>,</span><br><span class="line">   emp_name <span class="built_in">varchar</span>(<span class="number">255</span>),</span><br><span class="line">   namage_id <span class="built_in">int</span>,</span><br><span class="line">   <span class="keyword">foreign</span> <span class="keyword">key</span>(namage_id) <span class="keyword">reference</span> emp_table(emp_id)</span><br><span class="line">);</span><br><span class="line"><span class="comment">#向表中插入数据</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> emp_table</span><br><span class="line"><span class="keyword">value</span> (<span class="literal">null</span>,<span class="string">'唐僧'</span>,<span class="literal">null</span>),</span><br><span class="line">(<span class="literal">null</span>,<span class="string">'孙悟空'</span>，<span class="literal">null</span>)，</span><br><span class="line">(<span class="literal">null</span>,<span class="string">'猪八戒'</span>，<span class="literal">null</span>)，</span><br><span class="line">(<span class="literal">null</span>,<span class="string">'沙僧'</span>，<span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">#自定义查询</span></span><br><span class="line"><span class="keyword">select</span> emp.emp_id,emp.emp_name 员工名，mgr.emp_name 经理名</span><br><span class="line"><span class="keyword">from</span> emp_table emp,emp_table mgr</span><br><span class="line"><span class="keyword">where</span> emp.manage_id=mgr.emp_id;</span><br></pre></td></tr></table></figure></li>
</ul>
<p>2.SQL 99的连接查询：<code>多表连接查询的from后面只有一个表名</code></p>
<ul>
<li>交叉连接（cross join）：效果就是SQL92中的广义笛卡儿积，无需任何连接条件<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">select s.*,teacher_name</span><br><span class="line">#SQL 99多表连接查询的from后只有一个表名</span><br><span class="line">from student_table s</span><br><span class="line">#cross join 交叉连接，相当于广义笛卡儿积</span><br><span class="line">cross join teacher_table t；</span><br></pre></td></tr></table></figure></li>
<li>自然连接(natual join):自然连接表面上看起来无需指定连接条件，但自然连接是有连接条件的，<code>以两个表中的同名列作为连接条件</code>，如果两个表中没有同名列，则自然连接与交叉连接效果完全一样<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">select s.*,teacher_name</span><br><span class="line">#SQL 99多连接查询的from后只有一个表名</span><br><span class="line">from student_table s</span><br><span class="line">natual join teacher_table t;</span><br></pre></td></tr></table></figure></li>
<li>using子句连接：using子句可以指定一列或者多列，用于显式指定两个表中的同名列作为连接条件。<code>假设两个表中有超过一列的同名列，如果使用natual join，则会把所有同名列当成连接条件；如果使用using子句，就可显式指定使用哪些同名列作为连接条件</code><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">select s.*,teacher_name</span><br><span class="line">from student_table s</span><br><span class="line">#join 连接另一个表</span><br><span class="line">join teacher_tale t</span><br><span class="line">using(某一同名列)；</span><br></pre></td></tr></table></figure></li>
<li>on 子句连接：每个on子句只指定一个连接条件<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">select s.*,teacher_name</span><br><span class="line">from student_table s</span><br><span class="line">#join连接另一个表</span><br><span class="line">join teacher_table t</span><br><span class="line">#使用on指定连接条件</span><br><span class="line">on s.java_teacher = t.teacher_id;//也可以是非等值连接</span><br></pre></td></tr></table></figure></li>
<li>左、右、全外连接：分别使用<code>left [outer] join、right [outer] join和full [outer] join</code><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> s.*,teacher_name</span><br><span class="line"><span class="keyword">from</span> student_table s</span><br><span class="line"><span class="keyword">right</span>/<span class="keyword">left</span>/<span class="keyword">full</span> <span class="keyword">join</span> teacher_table t</span><br><span class="line"><span class="keyword">on</span> s.java_teacher &gt;t.teacher_id;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>左连接：会把左边表中所有满足连接条件的记录全部列出</p>
</blockquote>
</li>
</ul>
<blockquote>
<p>右连接：会把右边表中所有满足连接条件的记录全部列出,左边没有的为null</p>
</blockquote>
<blockquote>
<p>全外连接：会把两个表中所有满足连接条件的记录全部列出</p>
</blockquote>
<ul>
<li>内连接：<code>inner join</code>，可以返回结合两个表的数据</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> mismatch_topic.topic_id,mismatch_category.name</span><br><span class="line">    <span class="keyword">from</span> mismatch_topic</span><br><span class="line">    <span class="keyword">inner</span> <span class="keyword">join</span> mismatch_category</span><br><span class="line">    <span class="keyword">on</span> (mismatch_topic.category_id = mismatch_category.category_id)</span><br><span class="line">    <span class="keyword">where</span> mismatch_topic.name = <span class="string">'Horror movies;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>如果<code>要查询内容位于不同的表而列名相同</code>，可以使用<code>using代替on</code></p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">select mismatch_topic.topic_id,mismatch_category.name</span><br><span class="line">    from mismatch_topic</span><br><span class="line">    inner join mismatch_category</span><br><span class="line">    using (category_id)</span><br><span class="line">    where mismatch_topic.name = &apos;Horror movies;</span><br></pre></td></tr></table></figure>
<h2 id="子查询：在查询语句中嵌套另一个查询"><a href="#子查询：在查询语句中嵌套另一个查询" class="headerlink" title="子查询：在查询语句中嵌套另一个查询"></a>子查询：在查询语句中嵌套另一个查询</h2><ul>
<li>子查询可以出现在两个位置：<blockquote>
<p>出现在from语句后当成数据表，这种用法被称为行内视图，相当于一个临时视图</p>
</blockquote>
</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> *</span><br><span class="line"><span class="keyword">from</span> (<span class="keyword">select</span> * <span class="keyword">from</span> student_table) t <span class="comment">#必须给重命名</span></span><br><span class="line"><span class="keyword">where</span> t.java_teacher &gt;<span class="number">1</span>;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>出现在where条件后作为过滤条件的值</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">select *</span><br><span class="line">from student_table</span><br><span class="line">where java_teacher &gt;</span><br><span class="line">#返回单行、单列的子查询可以被标量值使用</span><br><span class="line">(select teacher_id </span><br><span class="line">from teacher_table</span><br><span class="line">  where teacher_name=&apos;Yeeku&apos;);</span><br></pre></td></tr></table></figure>

<ul>
<li>注意点：</li>
</ul>
<ol>
<li>子查询要用括号括起来</li>
<li>把子查询当成数据表时（出现在from之后），可以为该子查询起别名，尤其是<code>作为前缀来限定数据表时，必须给子查询起别名</code></li>
<li>把子查询当成过滤条件时，单行子查询使用单行运算符，多行子查询使用多行运算符</li>
</ol>
<ul>
<li>如果子查询返回多个值，则需要使用in、any、all等关键字</li>
</ul>
<blockquote>
<p>(not)in:把子查询返回的多个值当成一个值列表</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">select *</span><br><span class="line">from student_table</span><br><span class="line">where student_id in</span><br><span class="line">(select teacher_id</span><br><span class="line">from teacher_table);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>any和all可以与&gt;、&gt;=、&lt;、&lt;=、&lt;&gt;、=等运算符结合使用；</p>
</blockquote>
<blockquote>
<p><code>与any结合使用表示等于、大于等于、小于、小于等于、不等于、等于其中任意一个值；</code></p>
</blockquote>
<blockquote>
<p><code>与all结合使用分别表示等于、大于等于、小于、小于等于、不等于、等于全部值；</code></p>
</blockquote>
<blockquote>
<p>=any的作用与in作用相同</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">select *</span><br><span class="line">from student_table</span><br><span class="line">where student_id =</span><br><span class="line">any (select_teacher_id</span><br><span class="line">from teacher_table);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>“&lt;any” 只要小于值列表中的最大值即可，”&gt;any”只要大于值列表中的最小值即可，”&lt;all” 要求小于值列表中的最小值，”&gt;all”要求大于值列表中的最大值。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">select *</span><br><span class="line">from student_table</span><br><span class="line">where student_id &gt;</span><br><span class="line">all(select teacher_id</span><br><span class="line">from teacher_table);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>子查询可以返回多行、多列，此时where子句应该有对应的数据列，并使用圆括号将多个数据列组合起来</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">select *</span><br><span class="line">from student_table</span><br><span class="line">where (student_id,student_name)</span><br><span class="line">=any(select teacher_id,teacher_name</span><br><span class="line">from teacher_table);</span><br></pre></td></tr></table></figure>
<ul>
<li>带(not) exists关键字的子查询:若子查询内容不为空，则查询外层表，否则返回空表<blockquote>
<p>select 字段…from 表1 where exists (select 字段…from 表2)；</p>
</blockquote>
</li>
</ul>
<h2 id="集合运算"><a href="#集合运算" class="headerlink" title="集合运算"></a>集合运算</h2><p>select语句查询的结果是一个包含多条数据的结果集，可以进行<code>交（intersect）、并（union）和差（minus）运算</code></p>
<ul>
<li>对两个结果集进行集合运算，这两个结果集必须满足如下条件：<blockquote>
<p>对两个结果集所包含的<code>数据列的数量必须相等</code></p>
</blockquote>
</li>
</ul>
<blockquote>
<p>两个结果集所包含的数据列的<code>数据类型也必须一一对应</code></p>
</blockquote>
<ol>
<li>union运算<blockquote>
<p>select 语句 union select 语句</p>
</blockquote>
</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">select * from teacher_table</span><br><span class="line">union</span><br><span class="line">#这个结果集的数据列必须与前一个结果集的数据列一一对应</span><br><span class="line">select student_id,student_name from student_table;</span><br></pre></td></tr></table></figure>
<blockquote>
<p><code>union会自动把重复的内容去掉，若要不去掉重复内容，可使用 union all</code></p>
</blockquote>
<p>2.minus运算</p>
<blockquote>
<p>select 语句 minus select 语句</p>
</blockquote>
<ul>
<li>MySQL并不支持minus运算符，相同运算：<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> student_id,student_name <span class="keyword">from</span> student_table</span><br><span class="line"><span class="keyword">where</span> (student_id,student_name)</span><br><span class="line"><span class="keyword">not</span> <span class="keyword">in</span> </span><br><span class="line">(<span class="keyword">select</span> teacher_id,teacher_name <span class="keyword">from</span> teacher_table);</span><br></pre></td></tr></table></figure></li>
</ul>
<p>3.intersect运算</p>
<blockquote>
<p>select 语句 intersect select 语句</p>
</blockquote>
<ul>
<li>MySQL并不支持intersect语句，相同运算：<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> student_id ,student_name <span class="keyword">from</span> student_table</span><br><span class="line"><span class="keyword">join</span> </span><br><span class="line">teacher_table</span><br><span class="line"><span class="keyword">on</span> (student_id =teacher_id <span class="keyword">and</span> student_name=teacher_name);</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> student_id,student_name <span class="keyword">from</span> student_table</span><br><span class="line"><span class="keyword">join</span> </span><br><span class="line">teacher_table</span><br><span class="line"><span class="keyword">on</span> (student_id=teacher_id <span class="keyword">and</span> student_name=teacher_name)</span><br><span class="line"><span class="keyword">where</span> student_id&lt;<span class="number">4</span> <span class="keyword">and</span> teacher_name <span class="keyword">like</span> <span class="string">'李%'</span>;</span><br></pre></td></tr></table></figure>
<h2 id="触发器"><a href="#触发器" class="headerlink" title="触发器"></a>触发器</h2></li>
<li>触发器（trigger）由事件触发某个操作，这些事件包括insert into、updata、delete from语句</li>
<li>创建触发器</li>
</ul>
<ol>
<li>创建只有一个执行语句的触发器<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">create trigger 触发器名 before|after 触发事件</span><br><span class="line">on 表名 for each row  执行语句</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">create trigger trigger_name after insert</span><br><span class="line">on t_book for each row </span><br><span class="line">update t_booktype set bookNum=bookMun+1 where new.bookTypeId = t_booktype.id;</span><br></pre></td></tr></table></figure></li>
</ol>
<ul>
<li>过渡变量：<blockquote>
<p>new :<code>只能出现在insert和update出现时</code>，在insert时表示新插入的行数据，在update表示要替换的新数据</p>
</blockquote>
</li>
</ul>
<blockquote>
<p>old:<code>只能出现在delete和update出现时</code>，在delete时表示被删除的数据，在update表示被更改的原来的数据行</p>
</blockquote>
<ul>
<li>before 和after 的区别：<blockquote>
<p>before:在记录操纵之前触发，是先完成触发，在增删改，触发的语句先于监视的增删改；<code>（insert、update）可以对new进行修改</code></p>
</blockquote>
</li>
</ul>
<blockquote>
<p>after:在记录操纵之后触发，是先完成数据的增删改，再触发，触发的语句晚于监视的增删改操作；<code>不能对new进行修改</code></p>
</blockquote>
<blockquote>
<p><code>两者都不能对old进行修改</code></p>
</blockquote>
<ol start="2">
<li>创建有多个执行语句的触发器<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">delimiter |</span><br><span class="line">create trigger 触发器名 before|after 触发事件</span><br><span class="line">  on 表名 for each row</span><br><span class="line">  begin</span><br><span class="line">       执行语句列表;//每句后面用分号隔开</span><br><span class="line">   end</span><br><span class="line">| delimiter ;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>delimiter 重新定义结束符，保证完成全部操作，然后把结束符定义回分号 </p>
</blockquote>
</li>
</ol>
<blockquote>
<p><code>使用delimiter把触发器包括起来</code>，因为MySQL执行语句后面都要加分号</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">delimiter |</span><br><span class="line">  create trigger trig_name after delete</span><br><span class="line">      on t_book for each row</span><br><span class="line">      begin</span><br><span class="line">        update t_bookType set bookName=bookName-1 where old.bookTypeId=t_booktype.id;</span><br><span class="line">        insert into t_log values (null,now(),&apos;在book表里删除了一条数据&apos;);</span><br><span class="line">        delete from t_test where old.bookTypeId=t_test.id;</span><br><span class="line">      end</span><br><span class="line">| delimeter ;</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>查看触发器</li>
</ol>
<ul>
<li><code>show triggers</code>：查看所有触发器</li>
</ul>
<ol start="4">
<li>删除触发器<blockquote>
<p>drop trigger 触发器名；</p>
</blockquote>
<h2 id="存储过程和函数"><a href="#存储过程和函数" class="headerlink" title="存储过程和函数"></a>存储过程和函数</h2></li>
</ol>
<ul>
<li>存储过程和函数是在数据库中定义一些SQL语句的集合，然后直接调用这些存储过程和函数来执行已经定义好的SQL语句。</li>
<li>创建存储过程:<code>create procedure</code><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">create procedure 名称([proc_parameter[,...])</span><br><span class="line">     [characteristic...]routine_body</span><br></pre></td></tr></table></figure>
<blockquote>
<p>proc_premeter 表示存储过程的参数列表；每个参数由3部分组成，分别为<code>输出输入类型、参数名称、参数类型</code></p>
</blockquote>
</li>
</ul>
<blockquote>
<p><code>[in|out|inout]param_name type</code></p>
</blockquote>
<ul>
<li>其中in表示输入参数；out表示输出参数；inout表示既可以输入，也可以输出；<blockquote>
<p>characteristic 参数有多个取值：</p>
</blockquote>
</li>
</ul>
<ol>
<li><p>languange sql:说明routine_body部分由sql语句组成，这也是系统默认语言</p>
</li>
<li><p>[not] deterministic: 指明存储过程的执行结果是否是确定的。deterministic表示结果是确定的，<code>每次执行存储过程，相同输入会得到相同的输出</code>；not deterministic 表示结果是非确定的，<code>相同的输入可能得到不同的输出，默认情况下都是非确定的</code></p>
</li>
<li><p>{contains SQL|NO SQL|reads sql data|modifies SQL data}： 指明子程序使用sql语句的限制，<code>默认使用contains SQL</code></p>
<blockquote>
<p>contain sql:表示子程序包含SQL语句，<code>但不包含读或写数据的语句</code></p>
</blockquote>
</li>
</ol>
<blockquote>
<p>no sql： 表示<code>子程序中不包含SQL语句</code></p>
</blockquote>
<blockquote>
<p>read SQL data：表示<code>子程序中包含读数据的语句</code></p>
</blockquote>
<blockquote>
<p>modifies sql data： 表示<code>子程序中包含写数据的语句</code></p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">delimiter &amp;&amp;</span><br><span class="line">create procedure 存储过程名( in 变量 int,out count_num int)</span><br><span class="line">   read sql data</span><br><span class="line">   begin</span><br><span class="line">      select count(*) from 表名 where bookTypeId=变量；</span><br><span class="line">    end </span><br><span class="line">    &amp;&amp;</span><br><span class="line">delimiter ；</span><br></pre></td></tr></table></figure>
<ul>
<li>创建存储函数<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">create function 函数名([func_parameter[,..]])</span><br><span class="line">    return type</span><br><span class="line">    [characteristic..] routine_body</span><br></pre></td></tr></table></figure>
func_parameter 表示存储函数的参数列表；可以由多个参数组成，<code>每个参数由参数名称和参数类型组成</code>：<blockquote>
<p>参数名称 参数类型</p>
</blockquote>
</li>
</ul>
<p><code>return type指定返回值类型</code></p>
<p>characteristic 参数指定存储过程的特性，该参数的取值与存储过程中的取值是一样的</p>
<p>routine_body参数是SQL代码的内容，可以使用begin…end来标志SQL代码的开始和结束</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">delimiter &amp;&amp;</span><br><span class="line">create function func_book( 变量)</span><br><span class="line">  return varchar(20)</span><br><span class="line">  begin </span><br><span class="line">    return (select bookName from t_book where id=bookId);</span><br><span class="line">  end</span><br><span class="line">  &amp;&amp;</span><br><span class="line">delimiter ;</span><br></pre></td></tr></table></figure>

<ul>
<li>调用存储过程和函数</li>
</ul>
<p>1.调用存储过程：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">call 存储过程名(参数)</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>调用存储函数：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fun_name(参数)</span><br></pre></td></tr></table></figure></li>
</ol>
<ul>
<li>查看存储过程和函数</li>
</ul>
<ol>
<li><p>show status 语句查看存储过程和函数的状态( <code>只能查看属性状态</code>)</p>
<blockquote>
<p>show procedure|function status [like 存储过程名|函数名]</p>
</blockquote>
</li>
<li><p>show create语句查看存储过程的函数的定义(<code>能够查到定义</code>)</p>
<blockquote>
<p>show create procedure|function 存储过程名或函数名</p>
</blockquote>
</li>
</ol>
<ul>
<li><p>修改存储过程和函数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">alter prcedure|function 存储过程|函数名(变量)</span><br><span class="line">characteristic:</span><br><span class="line"> ( [contains SQL|no SQL|read SQL data|modifies SQL data|SQL security(definer|invoder])</span><br><span class="line"> comment &apos;string&apos;(修改内容)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>sql security指明谁有权限来执行，definer表示只有定义者自己才能够执行，invoder表示调用者也可以执行，comment’string’是注释信息</p>
</blockquote>
</li>
<li><p>删除存储过程和函数</p>
<blockquote>
<p>drop procedure|function 存储名或者函数名；</p>
</blockquote>
</li>
<li><p>变量的使用</p>
</li>
</ul>
<ol>
<li>定义变量<blockquote>
<p>declare var_name[,…] type [default value]</p>
</blockquote>
</li>
</ol>
<p>2.为变量赋值</p>
<blockquote>
<p>set var_name = expr[,var_name[,…]]</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select col_name[,..] into var_name[,...]</span><br><span class="line">          from table name where condition</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">#定义变量与使用第一种赋值方法</span><br><span class="line">delimiter &amp;&amp;</span><br><span class="line">create procedure pro_user()</span><br><span class="line">      begin</span><br><span class="line">         declare a,b varchar(20);</span><br><span class="line">         set a=&apos;XXXX&apos;,b=&apos;xxxx&apos;;</span><br><span class="line">         insert into t_user values (NULL,a,b)</span><br><span class="line">       end</span><br><span class="line">&amp;&amp;</span><br><span class="line">deliiter ;</span><br><span class="line"></span><br><span class="line">#第二种赋值</span><br><span class="line">delimiter &amp;&amp;</span><br><span class="line">create procedure pro_user()</span><br><span class="line">      begin</span><br><span class="line">         declare a,b varchar(20);</span><br><span class="line">         select userName，password into a,b from t_user2 where id=2;</span><br><span class="line">         insert into t_user values (NULL,a,b)</span><br><span class="line">       end</span><br><span class="line">&amp;&amp;</span><br><span class="line">deliiter ;</span><br></pre></td></tr></table></figure>
<ul>
<li>游标的使用<blockquote>
<p>查询语句可能查出多条记录，在存储过程和函数中必须<code>使用游标来逐条读取查询结果集中的记录</code>。游标的使用包括声明游标、打开游标、使用游标和关闭游标。<code>游标必须声明在处理程序之前，并且声明在变量和条件之后。</code></p>
</blockquote>
</li>
</ul>
<ol>
<li><p>声明游标</p>
<blockquote>
<p>delare cursor_name cursor for select_statement(对某个查询语句的游标）；</p>
</blockquote>
</li>
<li><p>打开游标</p>
<blockquote>
<p>open cursor_name;</p>
</blockquote>
</li>
<li><p>使用游标</p>
<blockquote>
<p>fetch cursor_name into var_name[,var_name…]</p>
</blockquote>
</li>
<li><p>关闭游标</p>
<blockquote>
<p>close cuesor_name;</p>
</blockquote>
</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">delimiter &amp;&amp;</span><br><span class="line">create procedure pro_user()</span><br><span class="line">      begin</span><br><span class="line">         declare a,b varchar(20);</span><br><span class="line">         declare 游标名 cursor for select userName,password from t_user;</span><br><span class="line">         open 游标名；</span><br><span class="line">         fetch 游标名 into a,b;</span><br><span class="line">         insert into t_user values (NULL,a,b);</span><br><span class="line">         close 游标名；</span><br><span class="line">       end</span><br><span class="line">&amp;&amp;</span><br><span class="line">deliiter ;</span><br></pre></td></tr></table></figure>
<ul>
<li>流程控制的使用<blockquote>
<p>流程控制语句包括if、case、loop、leave、iterate、repeat和while语句</p>
</blockquote>
</li>
</ul>
<ol>
<li>if语句<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">if search_condition then statement_list</span><br><span class="line">   [elseif search_condition then statement_list]...</span><br><span class="line">   [else statement_list]</span><br><span class="line">end if;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">delimiter &amp;&amp;</span><br><span class="line">create procedure pro_user(in bookId int)</span><br><span class="line">      begin</span><br><span class="line">         select count(*) into @num from t_user whrer id=bookId;</span><br><span class="line">         if @num&gt;0 then updata t_user set userName=&apos;xxxx&apos; where id=bookId;</span><br><span class="line">         else</span><br><span class="line">            insert into t_user values (NULL,&apos;xxxx&apos;,&apos;xxxxx&apos;);</span><br><span class="line">        end if;</span><br><span class="line">       end</span><br><span class="line">&amp;&amp;</span><br><span class="line">deliiter ;</span><br></pre></td></tr></table></figure></li>
<li>case 语句<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">case case_value</span><br><span class="line">   when when_value then statement_list</span><br><span class="line">   [when when_value then statement_list]...</span><br><span class="line">   [else ststement_list]</span><br><span class="line">end case;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">delimiter &amp;&amp;</span><br><span class="line">create procedure pro_user(in bookId int)</span><br><span class="line">      begin</span><br><span class="line">         select count(*) into @num from t_user whrer id=bookId;</span><br><span class="line">         case @num</span><br><span class="line">           when 1 then update t_user set user_name=&apos;xxx&apos; where id=bookId;</span><br><span class="line">           when 2 then insert into t_user values (NULL,&apos;xxx&apos;,&apos;xxxx&apos;);</span><br><span class="line">           else insert into t_user values(NULL,&apos;xxxx&apos;,&apos;xxxx&apos;);</span><br><span class="line">         end case;</span><br><span class="line">       end</span><br><span class="line">&amp;&amp;</span><br><span class="line">deliiter ;</span><br></pre></td></tr></table></figure></li>
<li>loop,leave语句<blockquote>
<p>loop 语句可以使某些特定的语句重复执行，实现一个简单的循环，但是<code>loop语句本身没有停止循环的语句，必须遇到leave语句等才能停止循环</code></p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[begin_label:]loop</span><br><span class="line">       statement_list</span><br><span class="line">end loop [end_label]</span><br></pre></td></tr></table></figure>
<blockquote>
<p>leave语句主要用于跳出循环：<code>leave label</code></p>
</blockquote>
</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">delimiter &amp;&amp;</span><br><span class="line">create procedure pro_user(in bookId int)</span><br><span class="line">      begin</span><br><span class="line">         aaa: loop</span><br><span class="line">           set totalNum=totalNum-1;</span><br><span class="line">           if totalNum=0 then leave aaa;</span><br><span class="line">           else insert into t_user values(totalNum,&apos;xxxx&apos;,&apos;xxxxx&apos;);</span><br><span class="line">           end if;</span><br><span class="line">         end loop aaa;</span><br><span class="line">       end</span><br><span class="line">&amp;&amp;</span><br><span class="line">deliiter ;</span><br></pre></td></tr></table></figure>
<ol start="4">
<li>iterate语句<blockquote>
<p>iterate 语句也是用来跳出循环的，但是iterate语句<code>跳出本次循环，然后进行下次循环</code>:<code>iterate label</code></p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">delimiter &amp;&amp;</span><br><span class="line">create procedure pro_user(in bookId int)</span><br><span class="line">      begin</span><br><span class="line">         aaa: loop</span><br><span class="line">           set totalNum=totalNum-1;</span><br><span class="line">           if totalNum=0 then leave aaa;</span><br><span class="line">           elseif totalNum=3 then iterate aaa;</span><br><span class="line">           end if;</span><br><span class="line">           insert into t_uesr values(totalNum,&apos;xxx&apos;,&apos;xxxxx&apos;);</span><br><span class="line">         end loop aaa;</span><br><span class="line">       end</span><br><span class="line">&amp;&amp;</span><br><span class="line">deliiter ;</span><br></pre></td></tr></table></figure></li>
<li>repeat语句<blockquote>
<p>repeat语句是有条件的循环语句，当满足特定条件时，就会跳出循环语句</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[begin_label:]repeat</span><br><span class="line">       statement_list</span><br><span class="line">       until search_condition</span><br><span class="line">end repeat[end_list]</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">delimiter &amp;&amp;</span><br><span class="line">create procedure pro_user(in bookId int)</span><br><span class="line">      begin</span><br><span class="line">        repeat </span><br><span class="line">            set totalNum=totalNum-1;</span><br><span class="line">            insert into t_user values (totalNum,&apos;xxxx&apos;,&apos;xxxxx&apos;);</span><br><span class="line">            until totalNum=1;</span><br><span class="line">        end repeat;</span><br><span class="line">       end</span><br><span class="line">&amp;&amp;</span><br><span class="line">deliiter ;</span><br></pre></td></tr></table></figure></li>
<li>while语句<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[begin_label:]while search_condition do(别忘了)</span><br><span class="line">     statement_list</span><br><span class="line">end while[end_label]</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">delimiter &amp;&amp;</span><br><span class="line">create procedure pro_user(in bookId int)</span><br><span class="line">      begin</span><br><span class="line">        while totalNum &gt;0 do</span><br><span class="line">            insert into t_user values (totalNum,&apos;xxxx&apos;,&apos;xxxxx&apos;);</span><br><span class="line">            set totalNum=totalNum-1；</span><br><span class="line">        end while;</span><br><span class="line">       end</span><br><span class="line">&amp;&amp;</span><br><span class="line">deliiter ;</span><br></pre></td></tr></table></figure>
<h1 id="事务"><a href="#事务" class="headerlink" title="事务"></a>事务</h1>事务表示进行一系列操作，在失败的情况下能够退回原来的状态，成功时则继续往下进行</li>
</ol>
<ul>
<li>使用<code>BEGIN</code>表示开始一个事务</li>
<li><code>COMMIT</code>:出现在事务中的最后，只有在所有的查询成功地执行之后才执行此命令</li>
<li><code>ROLLLBACK</code>:当事务中的系列查询的一个或者多个失败时将使用这个命令，并且把相关的表恢复到事务之前的状态（在每个执行语句后面都加）<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">BEGIN;</span><br><span class="line">数据库操作语句;</span><br><span class="line">ROLLBACK;</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">COMMIT;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h1 id="MySQL数据库导出和导入"><a href="#MySQL数据库导出和导入" class="headerlink" title="MySQL数据库导出和导入"></a>MySQL数据库导出和导入</h1><p>导出：</p>
<blockquote>
<p>mysqldump -u root -p 数据库名&gt; 导出的文件名及路径</p>
</blockquote>
<p>导入：（先创建数据库）</p>
<blockquote>
<p>mysql&gt;source 文件</p>
</blockquote>
<h1 id="MySQL创建用户和授权"><a href="#MySQL创建用户和授权" class="headerlink" title="MySQL创建用户和授权"></a>MySQL创建用户和授权</h1><p>创建：</p>
<blockquote>
<p>CREATE USER ‘用户名’ IDENTIFIED BY ‘密码’;</p>
</blockquote>
<p>授权：</p>
<blockquote>
<p>GRANT ALL/SELECT/UPDATE/DELETE/UPDATE ON 数据库名.指定表（或*） TO ‘用户名’;</p>
</blockquote>
<p>撤销权限：</p>
<blockquote>
<p>REVOKE ALL/… ON 数据库名 FROM ‘用户名‘@’localhost’;</p>
</blockquote>
<p>删除用户：</p>
<blockquote>
<p>DROP USER ‘用户名’;</p>
</blockquote>

    </div>

    
    
    
        <div class="reward-container">
  <div>打工不易，想买杯奶茶</div>
  <button disable="enable" onclick="var qr = document.getElementById(&quot;qr&quot;); qr.style.display = (qr.style.display === 'none') ? 'block' : 'none';">
    打赏
  </button>
  <div id="qr" style="display: none;">
      
      <div style="display: inline-block;">
        <img src="/images/wechatpay.png" alt="Silverming 微信支付">
        <p>微信支付</p>
      </div>
      
      <div style="display: inline-block;">
        <img src="/images/alipay.jpeg" alt="Silverming 支付宝">
        <p>支付宝</p>
      </div>

  </div>
</div>


      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2018/04/18/HTML%20CSS/" rel="prev" title="HTML CSS">
      <i class="fa fa-chevron-left"></i> HTML CSS
    </a></div>
      <div class="post-nav-item">
    <a href="/2018/04/21/php/" rel="next" title="php">
      php <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  

  </div>


          </div>
          

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#MySQL基本命令"><span class="nav-number">1.</span> <span class="nav-text">MySQL基本命令</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#MySQL数据库存储机制"><span class="nav-number">2.</span> <span class="nav-text">MySQL数据库存储机制</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#SQL语句基础"><span class="nav-number">3.</span> <span class="nav-text">SQL语句基础</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#DDL语句：操作数据库对象的语句"><span class="nav-number">3.1.</span> <span class="nav-text">DDL语句：操作数据库对象的语句</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#创建表的语法"><span class="nav-number">3.1.1.</span> <span class="nav-text">创建表的语法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#查看表结构的语法"><span class="nav-number">3.1.2.</span> <span class="nav-text">查看表结构的语法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#修改表结构的语法"><span class="nav-number">3.1.3.</span> <span class="nav-text">修改表结构的语法</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#增加列定义"><span class="nav-number">3.1.3.1.</span> <span class="nav-text">增加列定义</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#修改列定义"><span class="nav-number">3.1.3.2.</span> <span class="nav-text">修改列定义</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#删除列"><span class="nav-number">3.1.3.3.</span> <span class="nav-text">删除列</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#重命名数据表"><span class="nav-number">3.1.3.4.</span> <span class="nav-text">重命名数据表</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#完全改变列定义-change"><span class="nav-number">3.1.3.5.</span> <span class="nav-text">完全改变列定义 change</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#删除表的语法"><span class="nav-number">3.1.4.</span> <span class="nav-text">删除表的语法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#truncate-表"><span class="nav-number">3.1.5.</span> <span class="nav-text">truncate 表</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#数据库约束"><span class="nav-number">3.2.</span> <span class="nav-text">数据库约束</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#NOT-NULL约束"><span class="nav-number">3.2.1.</span> <span class="nav-text">NOT NULL约束</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#UNIQUE约束"><span class="nav-number">3.2.2.</span> <span class="nav-text">UNIQUE约束</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#PRIMARY-KEY约束"><span class="nav-number">3.2.3.</span> <span class="nav-text">PRIMARY KEY约束</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#FOREIGN-KEY约束"><span class="nav-number">3.2.4.</span> <span class="nav-text">FOREIGN KEY约束</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#索引"><span class="nav-number">3.3.</span> <span class="nav-text">索引</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#视图"><span class="nav-number">3.4.</span> <span class="nav-text">视图</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#DML语句：操作数据表里的数据"><span class="nav-number">3.5.</span> <span class="nav-text">DML语句：操作数据表里的数据</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#单表查询"><span class="nav-number">3.6.</span> <span class="nav-text">单表查询</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#group-by分组查询"><span class="nav-number">3.6.1.</span> <span class="nav-text">group by分组查询</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#limit-分页查询"><span class="nav-number">3.6.2.</span> <span class="nav-text">limit 分页查询</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#数据库函数"><span class="nav-number">3.7.</span> <span class="nav-text">数据库函数</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#连接函数"><span class="nav-number">3.7.0.1.</span> <span class="nav-text">连接函数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#截断和填充函数"><span class="nav-number">3.7.0.2.</span> <span class="nav-text">截断和填充函数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#定位和位置函数"><span class="nav-number">3.7.0.3.</span> <span class="nav-text">定位和位置函数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#子字符串函数"><span class="nav-number">3.7.0.4.</span> <span class="nav-text">子字符串函数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#字符串修改函数"><span class="nav-number">3.7.0.5.</span> <span class="nav-text">字符串修改函数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#加密函数"><span class="nav-number">3.7.0.6.</span> <span class="nav-text">加密函数</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#分组和组函数"><span class="nav-number">3.8.</span> <span class="nav-text">分组和组函数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#多表连接查询"><span class="nav-number">3.9.</span> <span class="nav-text">多表连接查询</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#子查询：在查询语句中嵌套另一个查询"><span class="nav-number">3.10.</span> <span class="nav-text">子查询：在查询语句中嵌套另一个查询</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#集合运算"><span class="nav-number">3.11.</span> <span class="nav-text">集合运算</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#触发器"><span class="nav-number">3.12.</span> <span class="nav-text">触发器</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#存储过程和函数"><span class="nav-number">3.13.</span> <span class="nav-text">存储过程和函数</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#事务"><span class="nav-number">4.</span> <span class="nav-text">事务</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#MySQL数据库导出和导入"><span class="nav-number">5.</span> <span class="nav-text">MySQL数据库导出和导入</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#MySQL创建用户和授权"><span class="nav-number">6.</span> <span class="nav-text">MySQL创建用户和授权</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Silverming</p>
  <div class="site-description" itemprop="description">Wechat:934933088</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">114</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">33</span>
        <span class="site-state-item-name">标签</span>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Silverming</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动 v4.0.0
  </div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">主题 – <a href="https://mist.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a> v7.5.0
  </div>
  <div>
     <a href="http://www.beianbeian.com/beianxinxi/56c155c0ed5f44020af3c1659377b89d.html" target="_blank" rel="noopener">粤ICP备18114217号</a>
  </div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








        
      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script>
<script src="/js/schemes/muse.js"></script>
<script src="/js/next-boot.js"></script>



  




  <script src="/js/local-search.js"></script>













  

  

</body>
</html>
